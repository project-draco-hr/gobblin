{
  if (shouldFetchFromSchemaRegistry(id)) {
    try {
      return fetchSchemaByID(id);
    }
 catch (    SchemaNotFoundException e) {
      addFetchToFailureHistory(id);
      throw e;
    }
  }
  throw new SchemaNotFoundException(String.format("Schema with ID = %s cannot be retrieved",id));
}
