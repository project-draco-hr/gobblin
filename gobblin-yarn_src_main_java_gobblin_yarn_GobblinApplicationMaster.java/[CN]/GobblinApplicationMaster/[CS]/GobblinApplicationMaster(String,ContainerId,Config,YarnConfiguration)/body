{
  super(ConfigUtils.configToProperties(config),applicationName);
  String applicationId=containerId.getApplicationAttemptId().getApplicationId().toString();
  String zkConnectionString=config.getString(GobblinYarnConfigurationKeys.ZK_CONNECTION_STRING_KEY);
  LOGGER.info("Using ZooKeeper connection string: " + zkConnectionString);
  this.helixManager=buildHelixManager(config,zkConnectionString);
  FileSystem fs=buildFileSystem(config);
  Path appWorkDir=YarnHelixUtils.getAppWorkDirPath(fs,applicationName,applicationId);
  GobblinYarnLogSource gobblinYarnLogSource=new GobblinYarnLogSource();
  if (gobblinYarnLogSource.isLogSourcePresent()) {
    addService(gobblinYarnLogSource.buildLogCopier(config,containerId,fs,appWorkDir));
  }
  addService(buildYarnService(config,applicationName,applicationId,yarnConfiguration,fs));
  addService(buildGobblinHelixJobScheduler(config,appWorkDir,getMetadataTags(applicationName,applicationId)));
  addService(buildJobConfigurationManager(config));
  if (UserGroupInformation.isSecurityEnabled()) {
    LOGGER.info("Adding YarnContainerSecurityManager since security is enabled");
    addService(buildYarnContainerSecurityManager(config,fs));
  }
}
