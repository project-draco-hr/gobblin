{
  Path outputTaskStateDir=new Path(this.appWorkDir,ConfigurationConstants.OUTPUT_TASK_STATE_DIR_NAME + Path.SEPARATOR + this.jobContext.getJobId());
  FileStatus[] fileStatuses=this.fs.listStatus(outputTaskStateDir,new PathFilter(){
    @Override public boolean accept(    Path path){
      return path.getName().endsWith(TASK_STATE_STORE_TABLE_SUFFIX);
    }
  }
);
  if (fileStatuses == null || fileStatuses.length == 0) {
    return Lists.newArrayList();
  }
  Queue<TaskState> taskStateQueue=Queues.newConcurrentLinkedQueue();
  Closer closer=Closer.create();
  try {
    ParallelRunner stateSerDeRunner=closer.register(new ParallelRunner(this.stateSerDeRunnerThreads,this.fs));
    for (    FileStatus status : fileStatuses) {
      LOGGER.info("Found output task state file " + status.getPath());
      stateSerDeRunner.deserializeFromSequenceFile(Text.class,TaskState.class,status.getPath(),taskStateQueue);
    }
  }
 catch (  Throwable t) {
    throw closer.rethrow(t);
  }
 finally {
    closer.close();
  }
  LOGGER.info(String.format("Collected task state of %d completed tasks",taskStateQueue.size()));
  return Lists.newArrayList(taskStateQueue);
}
