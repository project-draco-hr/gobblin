{
  StandardGobblinInstanceLauncher.Builder instanceLauncherBuilder=StandardGobblinInstanceLauncher.builder().withInstanceName("testDirectToExecutionDriver");
  instanceLauncherBuilder.driver();
  StandardGobblinInstanceLauncher instanceLauncher=instanceLauncherBuilder.build();
  instanceLauncher.startAsync();
  instanceLauncher.awaitRunning(50,TimeUnit.MILLISECONDS);
  JobSpec js1=JobSpec.builder().withConfig(ConfigFactory.parseResources("gobblin/runtime/instance/SimpleHelloWorldJob.jobconf")).build();
  GobblinInstanceDriver instance=instanceLauncher.getDriver();
  JobExecutionLauncher.StandardMetrics launcherMetrics=instance.getJobLauncher().getMetrics();
  checkLaunchJob(instanceLauncher,js1,instance);
  Assert.assertEquals(launcherMetrics.getNumJobsLaunched().getCount(),1);
  Assert.assertEquals(launcherMetrics.getNumJobsCompleted().getCount(),1);
  Assert.assertEquals(launcherMetrics.getNumJobsCommitted().getCount(),1);
  Assert.assertEquals(launcherMetrics.getNumJobsFailed().getCount(),0);
  Assert.assertEquals(launcherMetrics.getNumJobsRunning().getValue().intValue(),0);
  checkLaunchJob(instanceLauncher,js1,instance);
  Assert.assertEquals(launcherMetrics.getNumJobsLaunched().getCount(),2);
  Assert.assertEquals(launcherMetrics.getNumJobsCompleted().getCount(),2);
  Assert.assertEquals(launcherMetrics.getNumJobsCommitted().getCount(),2);
  Assert.assertEquals(launcherMetrics.getNumJobsFailed().getCount(),0);
  Assert.assertEquals(launcherMetrics.getNumJobsRunning().getValue().intValue(),0);
}
