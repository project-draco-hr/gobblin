{
  if (file.getAncestorsOwnerAndPermission() == null) {
    return;
  }
  Path parentPath=getStagingFilePath(file).getParent();
  for (  OwnerAndPermission ownerAndPermission : file.getAncestorsOwnerAndPermission()) {
    if (parentPath == null) {
      log.info("Ancestor owner and permission may not be set correctly. Exhausted parent paths before ancestor permissions");
      log.info(String.format("File destination path %s, AncestorOwnerAndPermissions size %s.",file.getDestination(),file.getAncestorsOwnerAndPermission().size()));
      break;
    }
    safeSetPathPermission(parentPath,ownerAndPermission);
    parentPath=parentPath.getParent();
  }
}
