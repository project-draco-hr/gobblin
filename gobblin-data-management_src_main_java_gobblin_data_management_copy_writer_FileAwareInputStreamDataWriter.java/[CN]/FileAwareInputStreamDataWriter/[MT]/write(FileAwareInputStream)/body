{
  fileAwareInputStream.getInputStream();
  Path stagingFile=getStagingFilePath(fileAwareInputStream.getFile());
  this.fs.mkdirs(stagingFile.getParent(),fileAwareInputStream.getFile().getDestinationOwnerAndPermission().getFsPermission());
  FSDataOutputStream os=this.fs.create(stagingFile,true);
  try {
    this.bytesWritten+=StreamUtils.copy(fileAwareInputStream.getInputStream(),os);
    log.info("bytes written: " + this.bytesWritten + " for file "+ fileAwareInputStream.getFile());
  }
  finally {
    os.close();
    fileAwareInputStream.getInputStream().close();
  }
  this.filesWritten++;
  setFilePermissions(fileAwareInputStream.getFile());
}
