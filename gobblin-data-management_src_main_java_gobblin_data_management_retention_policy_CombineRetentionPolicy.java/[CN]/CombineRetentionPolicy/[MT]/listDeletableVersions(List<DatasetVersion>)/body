{
  List<Set<DatasetVersion>> candidateDeletableVersions=Lists.newArrayList(Iterables.transform(this.retentionPolicies,new Function<RetentionPolicy<DatasetVersion>,Set<DatasetVersion>>(){
    @Nullable @Override public Set<DatasetVersion> apply(    RetentionPolicy<DatasetVersion> input){
      return Sets.newHashSet(input.listDeletableVersions(allVersions));
    }
  }
));
switch (this.combineOperation) {
case INTERSECT:
    return intersectDatasetVersions(candidateDeletableVersions);
case UNION:
  return unionDatasetVersions(candidateDeletableVersions);
default :
throw new RuntimeException("Combine operation " + this.combineOperation + " not recognized.");
}
}
