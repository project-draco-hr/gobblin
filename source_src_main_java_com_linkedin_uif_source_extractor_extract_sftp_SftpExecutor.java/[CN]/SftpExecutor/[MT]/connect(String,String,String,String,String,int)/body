{
  JSch.setLogger(new JSchLogger());
  JSch jsch=new JSch();
  Session session=null;
  log.info("Attempting to connect to source via SFTP");
  try {
    jsch.addIdentity(privateKey);
    jsch.setKnownHosts(knownHosts);
    session=jsch.getSession(userName,hostName);
    if (proxyHost != null && proxyPort >= 0) {
      session.setProxy(new ProxyHTTP(proxyHost,proxyPort));
    }
    UserInfo ui=new MyUserInfo();
    session.setUserInfo(ui);
    session.connect();
    log.info("Connection established to the SFTP source");
    return session;
  }
 catch (  JSchException e) {
    if (session != null) {
      session.disconnect();
    }
    log.error("Failed to establish a connection to the SFTP source",e);
    throw new RuntimeException("Failed to establish a connection to the SFTP source",e);
  }
}
