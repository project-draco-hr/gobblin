{
  if (!(wm instanceof MultiLongWatermark)) {
    throw new ClassCastException("Cannot compare MultiLongWatermark with " + wm.getClass().getSimpleName());
  }
  MultiLongWatermark other=(MultiLongWatermark)wm;
  ComparisonChain cc=ComparisonChain.start().compare(this.size(),other.size());
  for (int i=0; i < this.values.size(); i++) {
    cc.compare(this.values.get(i),other.values.get(i));
  }
  return cc.result();
}
