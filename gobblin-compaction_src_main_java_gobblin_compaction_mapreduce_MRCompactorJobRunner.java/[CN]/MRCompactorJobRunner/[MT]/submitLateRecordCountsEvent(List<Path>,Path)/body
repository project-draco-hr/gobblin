{
  try {
    Map<String,String> eventMetadataMap=Maps.newHashMap();
    long newLateRecordCount=this.lateInputRecordCountProvider.getRecordCount(newLateFilePaths);
    eventMetadataMap.put(NEW_LATE_RECORD_COUNTS,Long.toString(newLateRecordCount));
    eventMetadataMap.put(CUMULATIVE_LATE_RECORD_COUNTS,Long.toString(newLateRecordCount + this.lateOutputRecordCountProvider.getRecordCount(this.getCumulativeLateFilePaths(lateDataDir))));
    LOG.info("Submitting late event counts: " + eventMetadataMap);
    this.eventSubmitter.submit(LATE_RECORD_COUNTS_EVENT,eventMetadataMap);
  }
 catch (  Exception e) {
    LOG.error("Failed to submit late event count:" + e,e);
  }
}
