{
  Configuration conf=HadoopUtils.getConfFromState(this.jobProps);
  DateTime jobStartTime=new DateTime(DateTimeZone.forID(this.jobProps.getProp(ConfigurationKeys.COMPACTION_TIMEZONE,ConfigurationKeys.DEFAULT_COMPACTION_TIMEZONE)));
  if (this.jobProps.getPropAsBoolean(ConfigurationKeys.COMPACTION_JOB_LATE_DATA_MOVEMENT_TASK,false)) {
    List<Path> lateFilePaths=Lists.newArrayList();
    for (    String filePathString : this.jobProps.getPropAsList(ConfigurationKeys.COMPACTION_JOB_LATE_DATA_FILES)) {
      if (FilenameUtils.isExtension(filePathString,getApplicableFileExtensions())) {
        lateFilePaths.add(new Path(filePathString));
      }
    }
    Path lateDataOutputPath=this.deduplicate ? new Path(this.outputPath,ConfigurationKeys.COMPACTION_LATE_FILES_DIRECTORY) : this.outputPath;
    this.copyDataFiles(lateDataOutputPath,lateFilePaths,conf);
  }
 else {
    if (this.fs.exists(this.outputPath) && !canOverwriteOutputDir()) {
      LOG.warn(String.format("Output path %s exists. Will not compact %s.",this.outputPath,this.inputPath));
      return null;
    }
    addJars(conf);
    Job job=Job.getInstance(conf);
    this.configureJob(job);
    this.submitAndWait(job);
    this.moveTmpPathToOutputPath();
    this.submitSlaEvent(job);
  }
  this.markOutputDirAsCompleted(jobStartTime);
  return null;
}
