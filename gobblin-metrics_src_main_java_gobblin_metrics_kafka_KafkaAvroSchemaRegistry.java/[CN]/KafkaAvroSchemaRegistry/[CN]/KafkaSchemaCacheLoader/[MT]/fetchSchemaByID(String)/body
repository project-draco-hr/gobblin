{
  String schemaUrl=KafkaAvroSchemaRegistry.this.url + GET_RESOURCE_BY_ID + id;
  GetMethod get=new GetMethod(schemaUrl);
  int statusCode;
  String schemaString;
  try {
    statusCode=KafkaAvroSchemaRegistry.this.httpClient.executeMethod(get);
    schemaString=get.getResponseBodyAsString();
  }
  finally {
    get.releaseConnection();
  }
  if (statusCode != HttpStatus.SC_OK) {
    throw new SchemaNotFoundException(String.format("Schema with ID = %s cannot be retrieved, statusCode = %d",id,statusCode));
  }
  Schema schema;
  if (schemaString.startsWith("{")) {
    try {
      schema=new Schema.Parser().parse(schemaString);
    }
 catch (    Exception e) {
      throw new SchemaNotFoundException(String.format("Schema with ID = %s cannot be parsed",id),e);
    }
  }
 else {
    throw new SchemaNotFoundException(String.format("Schema with ID = %s cannot be parsed: schema should start with '{'",id));
  }
  return schema;
}
