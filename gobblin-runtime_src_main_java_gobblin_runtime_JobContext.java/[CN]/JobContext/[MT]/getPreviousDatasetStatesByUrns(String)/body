{
  Path stateStorePath=new Path(this.stateStoreRootDir,jobName);
  if (!this.stateStoreFs.exists(stateStorePath)) {
    return ImmutableMap.of();
  }
  FileStatus[] stateStoreFileStatuses=this.stateStoreFs.listStatus(stateStorePath,new PathFilter(){
    @Override public boolean accept(    Path path){
      return path.getName().endsWith("current" + JOB_STATE_STORE_TABLE_SUFFIX);
    }
  }
);
  if (stateStoreFileStatuses == null || stateStoreFileStatuses.length == 0) {
    return ImmutableMap.of();
  }
  Map<String,JobState> datasetStatesByUrns=Maps.newHashMap();
  for (  FileStatus stateStoreFileStatus : stateStoreFileStatuses) {
    List<JobState> previousDatasetStates=this.jobStateStore.getAll(jobName,stateStoreFileStatus.getPath().getName());
    if (!previousDatasetStates.isEmpty()) {
      JobState previousDatasetState=previousDatasetStates.get(0);
      datasetStatesByUrns.put(previousDatasetState.getProp(ConfigurationKeys.DATASET_URN_KEY,ConfigurationKeys.DEFAULT_DATASET_URN),previousDatasetState);
    }
  }
  return datasetStatesByUrns;
}
