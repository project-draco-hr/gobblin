{
  this.closer=Closer.create();
  this.byteArrayOutputStream=new ByteArrayOutputStream();
  this.out=this.closer.register(new DataOutputStream(byteArrayOutputStream));
  this.encoder=getEncoder(schema,this.out);
  this.schemaVersionWriter=schemaVersionWriter;
  this.writer=new SpecificDatumWriter<T>(schema);
}
