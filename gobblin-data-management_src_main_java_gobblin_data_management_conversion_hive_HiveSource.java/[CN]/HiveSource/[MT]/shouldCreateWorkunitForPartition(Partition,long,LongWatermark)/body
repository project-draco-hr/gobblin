{
  try {
    if (this.lookBackUpdateProvider.isPresent()) {
      DateTime maxLookbackTime=new DateTime().minusDays(this.maxLookBackDays);
      return Long.compare(this.lookBackUpdateProvider.get().getUpdateTime(partition),maxLookbackTime.getMillis()) > 0 && Long.compare(updateTime,lowWatermark.getValue()) > 0;
    }
 else {
      return Long.compare(updateTime,lowWatermark.getValue()) > 0;
    }
  }
 catch (  UpdateNotFoundExecption e) {
    log.warn(String.format("Not creating workunit for partition %s as it failed to get update time. %s",partition.getCompleteName(),e.getMessage()));
    return false;
  }
}
