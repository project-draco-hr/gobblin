{
  System.out.println("====Checking for expected messages. Will list all messages.====");
  try {
    while (it.hasNext()) {
      KafkaReporter.Metric metric=nextMetric(it);
      if (expected.contains(metric.name)) {
        expected.remove(metric.name);
      }
 else       if (strict) {
        Assert.assertTrue(false,"Message present in kafka not expected: " + metric.toString());
      }
    }
  }
 catch (  ConsumerTimeoutException e) {
    Assert.assertTrue(expected.isEmpty());
  }
}
