{
  Collections.sort(workUnits,LOAD_DESC_COMPARATOR);
  PriorityQueue<MultiWorkUnit> pQueue=new PriorityQueue<MultiWorkUnit>(workUnits.size(),LOAD_DESC_COMPARATOR);
  for (  WorkUnit workUnit : workUnits) {
    MultiWorkUnit bestGroup=findAndPopBestFitGroup(workUnit,pQueue,avgGroupSize);
    if (bestGroup != null) {
      addWorkUnitToMultiWorkUnit(workUnit,bestGroup);
    }
 else {
      bestGroup=new MultiWorkUnit();
      addWorkUnitToMultiWorkUnit(workUnit,bestGroup);
    }
    pQueue.add(bestGroup);
  }
  return Lists.newArrayList(pQueue);
}
