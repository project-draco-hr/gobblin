{
  LOGGER.info("Beginning to download file: " + file);
  try {
    InputStream inputStream=this.closer.register(this.fsHelper.getFileStream(file));
    Iterator<D> fileItr=(Iterator<D>)IOUtils.lineIterator(inputStream,ConfigurationKeys.DEFAULT_CHARSET_ENCODING);
    if (workUnitState.getPropAsBoolean(ConfigurationKeys.SOURCE_SKIP_FIRST_RECORD,false) && fileItr.hasNext()) {
      fileItr.next();
    }
    return fileItr;
  }
 catch (  FileBasedHelperException e) {
    throw new IOException("Exception while downloading file " + file + " with message "+ e.getMessage(),e);
  }
}
