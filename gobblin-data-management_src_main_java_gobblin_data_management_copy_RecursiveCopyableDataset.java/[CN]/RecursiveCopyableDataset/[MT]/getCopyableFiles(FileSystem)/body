{
  List<FileStatus> files=FileListUtils.listFilesRecursively(this._fs,this.rootPath,this.pathFilter);
  List<CopyableFile> copyableFiles=Lists.newArrayList();
  for (  FileStatus file : files) {
    Path outputPath=new Path(this.targetDirectory,PathUtils.relativizePath(PathUtils.getPathWithoutSchemeAndAuthority(file.getPath()),PathUtils.getPathWithoutSchemeAndAuthority(datasetRoot())));
    OwnerAndPermission ownerAndPermission=new OwnerAndPermission(file.getOwner(),file.getGroup(),file.getPermission());
    List<OwnerAndPermission> ancestorOwnerAndPermissions=Lists.newArrayList();
    try {
      Path currentPath=PathUtils.getPathWithoutSchemeAndAuthority(file.getPath());
      while (currentPath != null && !currentPath.getParent().equals(this.rootPath)) {
        currentPath=currentPath.getParent();
        ancestorOwnerAndPermissions.add(this.ownerAndPermissionCache.get(currentPath));
      }
    }
 catch (    ExecutionException ee) {
    }
    FileChecksum checksum=this._fs.getFileChecksum(file.getPath());
    copyableFiles.add(new CopyableFile(file,this.targetDirectory,ownerAndPermission,ancestorOwnerAndPermissions,checksum == null ? new byte[0] : checksum.getBytes()));
  }
  return copyableFiles;
}
