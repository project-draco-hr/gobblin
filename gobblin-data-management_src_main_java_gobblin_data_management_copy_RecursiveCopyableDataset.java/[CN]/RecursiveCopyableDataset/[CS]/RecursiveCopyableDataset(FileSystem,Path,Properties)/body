{
  this.rootPath=PathUtils.getPathWithoutSchemeAndAuthority(rootPath);
  this.fs=fs;
  this.properties=properties;
  this.ownerAndPermissionCache=CacheBuilder.newBuilder().build(new CacheLoader<Path,OwnerAndPermission>(){
    @Override public OwnerAndPermission load(    Path path) throws Exception {
      FileStatus fileStatus=fs.getFileStatus(path);
      return new OwnerAndPermission(fileStatus.getOwner(),fileStatus.getGroup(),fileStatus.getPermission());
    }
  }
);
  this.pathFilter=DatasetUtils.instantiatePathFilter(properties);
}
