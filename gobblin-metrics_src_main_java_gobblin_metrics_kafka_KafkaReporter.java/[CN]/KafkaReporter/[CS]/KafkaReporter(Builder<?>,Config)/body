{
  super(builder,config);
  SchemaVersionWriter versionWriter=config.hasPath(SCHEMA_VERSION_WRITER_TYPE) ? SchemaVersionWriter.Type.valueOf(config.getString(SCHEMA_VERSION_WRITER_TYPE)).getVersionWriter() : SchemaVersionWriter.Type.FIXED_VERSION.getVersionWriter();
  log.info("Schema version writer: " + versionWriter.getClass().getName());
  this.serializer=this.closer.register(createSerializer(versionWriter));
  if (builder.kafkaPusher.isPresent()) {
    this.kafkaPusher=builder.kafkaPusher.get();
  }
 else {
    this.kafkaPusher=this.closer.register(new KafkaPusher(builder.brokers,builder.topic));
  }
}
