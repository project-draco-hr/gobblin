{
  String topicName1="testTopic1";
  String topicName2="testTopic2";
  String topicName3="otherTestTopic1";
  KafkaTopic topic1=createDummyKafkaTopic(topicName1);
  KafkaTopic topic2=createDummyKafkaTopic(topicName2);
  KafkaTopic topic3=createDummyKafkaTopic(topicName3);
  String testKey1="testKey1";
  String testValue1="testValue1";
  SourceState state=new SourceState();
  state.setProp(KafkaSource.KAFKA_TOPIC_SPECIFIC_STATE,"[{\"topic.name\" : \"testTopic.*\", \"" + testKey1 + "\" : \""+ testValue1+ "\"}]");
  KafkaSource<?,?> dummyKafkaSource=new KafkaDummySource();
  Map<KafkaTopic,State> topicSpecificStateMap=dummyKafkaSource.getTopicSpecificState(Lists.newArrayList(topic1,topic2,topic3),state);
  State topic1ExpectedState=new State();
  topic1ExpectedState.setProp(testKey1,testValue1);
  State topic2ExpectedState=new State();
  topic2ExpectedState.setProp(testKey1,testValue1);
  Assert.assertEquals(topicSpecificStateMap.get(topic1),topic1ExpectedState);
  Assert.assertEquals(topicSpecificStateMap.get(topic2),topic2ExpectedState);
  Assert.assertNull(topicSpecificStateMap.get(topic3));
}
