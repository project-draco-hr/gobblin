{
  try {
    long updateTime=this.updateProvider.getUpdateTime(hiveDataset.getTable());
    LongWatermark lowWatermark=this.watermarker.getPreviousHighWatermark(hiveDataset.getTable());
    if (shouldCreateWorkunit(updateTime,lowWatermark)) {
      log.debug(String.format("Processing table: %s",hiveDataset.getTable()));
      HiveWorkUnit hiveWorkUnit=new HiveWorkUnit(hiveDataset);
      hiveWorkUnit.setTableSchemaUrl(this.avroSchemaManager.getSchemaUrl(hiveDataset.getTable()));
      hiveWorkUnit.setWatermarkInterval(new WatermarkInterval(lowWatermark,expectedDatasetHighWatermark));
      EventWorkunitUtils.setTableSlaEventMetadata(hiveWorkUnit,hiveDataset.getTable(),updateTime,lowWatermark.getValue());
      this.workunits.add(hiveWorkUnit);
      log.debug(String.format("Workunit added for table: %s",hiveWorkUnit));
    }
 else {
      log.info(String.format("Not creating workunit for table %s as updateTime %s is lesser than low watermark %s",hiveDataset.getTable().getCompleteName(),updateTime,lowWatermark.getValue()));
    }
  }
 catch (  UpdateNotFoundException e) {
    log.info(String.format("Not Creating workunit for %s as update time was not found. %s",hiveDataset.getTable().getCompleteName(),e.getMessage()));
  }
}
