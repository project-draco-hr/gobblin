{
  String watermarkType=workUnitState.getProp(ConfigurationKeys.SOURCE_QUERYBASED_WATERMARK_TYPE,ConfigurationKeys.DEFAULT_WATERMARK_TYPE);
  long lowWaterMark=workUnitState.getWorkunit().getLowWaterMark();
  if (lowWaterMark == ConfigurationKeys.DEFAULT_WATERMARK_VALUE) {
    return lowWaterMark;
  }
  WatermarkType wmType=WatermarkType.valueOf(watermarkType.toUpperCase());
  int deltaNum=new WatermarkPredicate(wmType).getDeltaNumForNextWatermark();
switch (wmType) {
case SIMPLE:
    return lowWaterMark - deltaNum;
default :
  Date lowWaterMarkDate=Utils.toDate(lowWaterMark,"yyyyMMddHHmmss");
return Long.parseLong(Utils.dateToString(Utils.addSecondsToDate(lowWaterMarkDate,deltaNum * -1),"yyyyMMddHHmmss"));
}
}
