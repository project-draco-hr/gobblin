{
  Preconditions.checkArgument(properties.containsKey(DB_KEY));
  this.fs=fs;
  this.hiveProps=new HiveRegProps(new State(properties));
  GenericObjectPoolConfig config=new GenericObjectPoolConfig();
  config.setMaxTotal(this.hiveProps.getNumThreads());
  config.setMaxIdle(this.hiveProps.getNumThreads());
  HiveMetaStoreClientFactory factory=new HiveMetaStoreClientFactory(Optional.fromNullable(properties.getProperty(HIVE_METASTORE_URI_KEY)));
  this.clientPool=new GenericObjectPool<>(factory,config);
  this.db=properties.getProperty(DB_KEY);
  this.tablePattern=properties.getProperty(TABLE_PATTERN_KEY,DEFAULT_TABLE_PATTERN);
  this.properties=properties;
}
