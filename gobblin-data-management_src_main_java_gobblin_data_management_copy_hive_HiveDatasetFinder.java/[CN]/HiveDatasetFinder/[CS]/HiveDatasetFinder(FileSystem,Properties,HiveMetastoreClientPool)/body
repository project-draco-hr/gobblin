{
  this.properties=properties;
  this.clientPool=clientPool;
  this.fs=fs;
  String whitelistKey=HIVE_DATASET_PREFIX + "." + WhitelistBlacklist.WHITELIST;
  Preconditions.checkArgument(properties.containsKey(DB_KEY) || properties.containsKey(whitelistKey),String.format("Must specify %s or %s.",DB_KEY,whitelistKey));
  Config config=ConfigFactory.parseProperties(properties);
  if (properties.containsKey(DB_KEY)) {
    this.whitelistBlacklist=new WhitelistBlacklist(this.properties.getProperty(DB_KEY) + "." + this.properties.getProperty(TABLE_PATTERN_KEY,DEFAULT_TABLE_PATTERN),"");
  }
 else {
    this.whitelistBlacklist=new WhitelistBlacklist(config.getConfig(HIVE_DATASET_PREFIX));
  }
}
