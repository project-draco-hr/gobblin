{
  return Iterators.transform(getTables().iterator(),new Function<DbAndTable,HiveDataset>(){
    @Override public HiveDataset apply(    @Nullable DbAndTable dbAndTable){
      if (dbAndTable == null) {
        return null;
      }
      try (AutoReturnableObject<IMetaStoreClient> client=HiveDatasetFinder.this.clientPool.getClient()){
        Table table=client.get().getTable(dbAndTable.getDb(),dbAndTable.getTable());
        return createHiveDataset(table);
      }
 catch (      IOException|TException ioe) {
        throw new RuntimeException(ioe);
      }
    }
  }
);
}
