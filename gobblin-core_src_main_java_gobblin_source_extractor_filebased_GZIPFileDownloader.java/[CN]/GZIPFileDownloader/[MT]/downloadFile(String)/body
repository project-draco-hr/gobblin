{
  log.info("Beginning to download gzip compressed file: " + file);
  try {
    InputStream inputStream=fileBasedExtractor.getCloser().register(fileBasedExtractor.getFsHelper().getFileStream(file));
    Iterator<D> fileItr=(Iterator<D>)IOUtils.lineIterator(new GZIPInputStream(inputStream),ConfigurationKeys.DEFAULT_CHARSET_ENCODING.name());
    if (fileBasedExtractor.isShouldSkipFirstRecord() && fileItr.hasNext()) {
      fileItr.next();
    }
    return fileItr;
  }
 catch (  FileBasedHelperException e) {
    throw new IOException("Exception while downloading file " + file + " with message "+ e.getMessage(),e);
  }
}
