{
  this.applicationName=applicationName;
  this.applicationId=applicationId;
  this.config=config;
  this.yarnConfiguration=new YarnConfiguration();
  this.amrmClientAsync=closer.register(AMRMClientAsync.createAMRMClientAsync(1000,new AMRMClientCallbackHandler()));
  this.amrmClientAsync.init(this.yarnConfiguration);
  this.nmClientAsync=closer.register(NMClientAsync.createNMClientAsync(new NMClientCallbackHandler()));
  this.nmClientAsync.init(this.yarnConfiguration);
  this.containerLaunchExecutor=Executors.newFixedThreadPool(10,ExecutorsUtils.newThreadFactory(Optional.of(LOGGER),Optional.of("ContainerLaunchExecutor")));
  this.fs=fs;
  this.eventBus=eventBus;
  this.initialContainers=config.getInt(ConfigurationConstants.INITIAL_CONTAINERS_KEY);
  this.requestedContainerMemoryMbs=config.getInt(ConfigurationConstants.CONTAINER_MEMORY_MBS_KEY);
  this.requestedContainerCores=config.getInt(ConfigurationConstants.CONTAINER_CORES_KEY);
  this.containerJvmArgs=containerJvmArgs;
  this.tokens=getSecurityTokens();
  this.eventBus.register(this);
}
