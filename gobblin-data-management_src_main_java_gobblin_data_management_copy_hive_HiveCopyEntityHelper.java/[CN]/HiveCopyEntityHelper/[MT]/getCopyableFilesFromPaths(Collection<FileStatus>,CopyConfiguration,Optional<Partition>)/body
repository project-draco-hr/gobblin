{
  List<CopyableFile.Builder> builders=Lists.newArrayList();
  List<SourceAndDestination> dataFiles=Lists.newArrayList();
  Configuration hadoopConfiguration=new Configuration();
  FileSystem actualSourceFs=null;
  String referenceScheme=null;
  String referenceAuthority=null;
  for (  FileStatus status : paths) {
    dataFiles.add(new SourceAndDestination(status,getTargetPath(status.getPath(),this.targetFs,partition,true)));
  }
  for (  SourceAndDestination sourceAndDestination : dataFiles) {
    URI uri=sourceAndDestination.getSource().getPath().toUri();
    if (actualSourceFs == null || !StringUtils.equals(referenceScheme,uri.getScheme()) || !StringUtils.equals(referenceAuthority,uri.getAuthority())) {
      actualSourceFs=sourceAndDestination.getSource().getPath().getFileSystem(hadoopConfiguration);
      referenceScheme=uri.getScheme();
      referenceAuthority=uri.getAuthority();
    }
    builders.add(CopyableFile.fromOriginAndDestination(actualSourceFs,sourceAndDestination.getSource(),sourceAndDestination.getDestination(),configuration));
  }
  return builders;
}
