{
  Set<Path> targetPaths=Sets.newHashSet();
  for (  Path path : paths) {
    targetPaths.add(getTargetPath(sourceFs.getFileStatus(path),targetFs,partition));
  }
  if (targetPaths.size() != 1) {
    throw new IOException("Can only register exactly one path. Trying to register " + HiveDataset.joiner.join(targetPaths));
  }
  return targetPaths.iterator().next();
}
