{
  int stepPriority=initialPriority;
  InputFormat<?,?> inputFormat=HiveDataset.getInputFormat(partition.getTPartition().getSd());
  Collection<Path> partitionPaths=HiveDataset.getPaths(inputFormat,partition.getLocation());
  DeleteFileCommitStep deletePaths=DeleteFileCommitStep.fromPaths(targetFs,partitionPaths,this.dataset.properties);
  copyEntities.add(new PrePublishStep(fileSet,Maps.<String,Object>newHashMap(),deletePaths,stepPriority++));
  PartitionDeregisterStep deregister=new PartitionDeregisterStep(table.getTTable(),partition.getTPartition(),targetURI,hiveRegProps);
  copyEntities.add(new PrePublishStep(fileSet,Maps.<String,Object>newHashMap(),deregister,stepPriority++));
  return stepPriority;
}
