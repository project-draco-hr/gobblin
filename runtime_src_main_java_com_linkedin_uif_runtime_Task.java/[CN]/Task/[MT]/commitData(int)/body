{
  LOG.info(String.format("Committing data of branch %d of task %s",index,this.taskId));
  try {
    this.writers.get(index).commit();
    this.taskState.setWorkingState(WorkUnitState.WorkingState.SUCCESSFUL);
    if (JobMetrics.isEnabled(this.taskState.getWorkunit())) {
      updateByteMetrics();
    }
  }
 catch (  IOException ioe) {
    if (this.taskState.getWorkingState() != WorkUnitState.WorkingState.SUCCESSFUL) {
      LOG.error("Failed to commit data of task " + this.taskId,ioe);
    }
  }
}
