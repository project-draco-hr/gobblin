{
  LOG.info("Committing data of task " + this.taskId);
  try {
    this.writer.commit();
    this.taskState.setWorkingState(WorkUnitState.WorkingState.SUCCESSFUL);
    if (JobMetrics.isEnabled(this.taskState.getWorkunit())) {
      updateByteMetrics();
    }
  }
 catch (  IOException ioe) {
    if (this.taskState.getWorkingState() != WorkUnitState.WorkingState.SUCCESSFUL) {
      LOG.error("Failed to commit data of task " + this.taskId,ioe);
    }
  }
}
