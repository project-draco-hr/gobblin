{
  for (int i=0; i < branches; i++) {
    DataWriterBuilder builder=this.taskContext.getDataWriterBuilder(branches,i);
    String branchName=ForkOperatorUtils.getBranchName(this.taskState,i,ConfigurationKeys.DEFAULT_FORK_BRANCH_NAME + i);
    this.taskState.setProp(ForkOperatorUtils.getPropertyNameForBranch(ConfigurationKeys.WRITER_FILE_PATH,branches,i),ForkOperatorUtils.getPathForBranch(this.taskState.getExtract().getOutputFilePath(),branchName,branches));
    DataWriter writer=builder.writeTo(Destination.of(context.getDestinationType(branches,i),this.taskState)).writeInFormat(context.getWriterOutputFormat(branches,i)).withWriterId(this.taskId).withSchema(schemas.get(i).get()).forBranch(branches > 1 ? i : -1).build();
    this.writers.add(writer);
  }
}
