{
  Multimap<Extract,WorkUnitState> successfulExtracts=ArrayListMultimap.create();
  Multimap<Extract,WorkUnitState> failedExtracts=ArrayListMultimap.create();
  for (  Map.Entry<Extract,Collection<WorkUnitState>> entry : extractToWorkUnitStateMap.asMap().entrySet()) {
    if (Iterables.all(entry.getValue(),predicate)) {
      successfulExtracts.putAll(entry.getKey(),entry.getValue());
    }
 else {
      failedExtracts.putAll(entry.getKey(),entry.getValue());
    }
  }
  return new SplitExtractsResult(successfulExtracts,failedExtracts);
}
