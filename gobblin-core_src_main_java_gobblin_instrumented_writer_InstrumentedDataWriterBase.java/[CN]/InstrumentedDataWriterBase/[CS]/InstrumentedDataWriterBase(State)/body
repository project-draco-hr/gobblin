{
  this.closer=Closer.create();
  this.metricContext=this.closer.register(Instrumented.getMetricContext(state,this.getClass()));
  this.recordsInMeter=this.metricContext.meter(MetricNames.DataWriterMetrics.RECORDS_IN_METER);
  this.successfulWriteMeter=this.metricContext.meter(MetricNames.DataWriterMetrics.RECORDS_WRITTEN_METER);
  this.exceptionWriteMeter=this.metricContext.meter(MetricNames.DataWriterMetrics.RECORDS_FAILED_METER);
  this.dataWriterTimer=this.metricContext.timer(MetricNames.DataWriterMetrics.WRITE_TIMER);
}
