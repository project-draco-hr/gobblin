{
  this.closer=Closer.create();
  this.metricContext=this.closer.register(Instrumented.getMetricContext(state,this.getClass()));
  this.recordsInMeter=this.metricContext.meter(MetricNames.DataWriter.RECORDS_IN);
  this.successfulWriteMeter=this.metricContext.meter(MetricNames.DataWriter.RECORDS_WRITTEN);
  this.exceptionWriteMeter=this.metricContext.meter(MetricNames.DataWriter.RECORDS_FAILED);
  this.dataWriterTimer=this.metricContext.timer(MetricNames.DataWriter.WRITE_TIME);
}
