{
  List<String> self=getRawTags(urn);
  List<String> res=new ArrayList<String>();
  for (  String s : self) {
    if (previousTags.contains(s)) {
      throw new TagCircularDependencyException("Circular dependence for tag " + s);
    }
    res.add(s);
    Set<String> combined=new HashSet<String>(previousTags);
    combined.add(s);
    res.addAll(getAssociatedTagsWithCheck(s,combined));
  }
  String parentId=DatasetUtils.getParentId(getAdjustedUrn(urn));
  if (!parentId.equals(DatasetUtils.ROOT)) {
    Set<String> selfChain=new HashSet<String>(getUrnTillAdjustedUrn(urn,parentId));
    List<String> ancestorTags=getAssociatedTagsWithCheck(parentId,selfChain);
    res.addAll(ancestorTags);
  }
  return dedup(res);
}
