{
  AvroKeyCompactorOutputCommitter.FilenameRecordCountProvider filenameRecordCountProvider=new AvroKeyCompactorOutputCommitter.FilenameRecordCountProvider();
  Pattern pattern=Pattern.compile("part\\-r\\-123\\.[\\d]*\\.[\\d]*\\.avro");
  Assert.assertTrue(pattern.matcher(filenameRecordCountProvider.constructFileName("part-r-",123)).matches());
  Assert.assertEquals(filenameRecordCountProvider.getRecordCount(new Path("part-r-123.1.2.avro")),123);
}
