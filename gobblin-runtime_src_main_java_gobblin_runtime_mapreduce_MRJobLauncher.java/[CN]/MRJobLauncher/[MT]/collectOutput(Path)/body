{
  List<TaskState> taskStates=Lists.newArrayList();
  FileStatus[] fileStatuses=this.fs.listStatus(taskStatePath,new PathFilter(){
    @Override public boolean accept(    Path path){
      return path.getName().endsWith(TASK_STATE_STORE_TABLE_SUFFIX);
    }
  }
);
  if (fileStatuses == null || fileStatuses.length == 0) {
    return taskStates;
  }
  for (  FileStatus status : fileStatuses) {
    Closer closer=Closer.create();
    try {
      SequenceFile.Reader reader=closer.register(new SequenceFile.Reader(this.fs,status.getPath(),this.fs.getConf()));
      Text text=new Text();
      TaskState taskState=new TaskState();
      while (reader.next(text,taskState)) {
        taskStates.add(taskState);
        taskState=new TaskState();
      }
    }
 catch (    Throwable t) {
      throw closer.rethrow(t);
    }
 finally {
      closer.close();
    }
  }
  LOG.info(String.format("Collected task state of %d completed tasks",taskStates.size()));
  return taskStates;
}
