{
  TimingEvent mrJobSetupTimer=this.eventSubmitter.getTimingEvent(TimingEventNames.RunJobTimings.MR_JOB_SETUP);
  this.job.setJarByClass(MRJobLauncher.class);
  this.job.setMapperClass(TaskRunner.class);
  this.job.setNumReduceTasks(0);
  this.job.setInputFormatClass(NLineInputFormat.class);
  this.job.setOutputFormatClass(GobblinOutputFormat.class);
  this.job.setMapOutputKeyClass(NullWritable.class);
  this.job.setMapOutputValueClass(NullWritable.class);
  this.job.setSpeculativeExecution(false);
  Path jobInputFile=prepareJobInput(workUnits);
  NLineInputFormat.addInputPath(this.job,jobInputFile);
  SequenceFileOutputFormat.setOutputPath(this.job,this.jobOutputPath);
  Path jobStateFilePath=new Path(this.mrJobDir,JOB_STATE_FILE_NAME);
  int jobStateRF=this.conf.getInt("dfs.replication.max",20);
  SerializationUtils.serializeState(this.fs,jobStateFilePath,this.jobContext.getJobState(),jobStateRF);
  job.getConfiguration().set(ConfigurationKeys.JOB_STATE_FILE_PATH_KEY,jobStateFilePath.toString());
  if (this.jobProps.containsKey(ConfigurationKeys.MR_JOB_MAX_MAPPERS_KEY)) {
    int maxMappers=Integer.parseInt(this.jobProps.getProperty(ConfigurationKeys.MR_JOB_MAX_MAPPERS_KEY));
    if (workUnits.size() > maxMappers) {
      int numTasksPerMapper=workUnits.size() % maxMappers == 0 ? workUnits.size() / maxMappers : workUnits.size() / maxMappers + 1;
      NLineInputFormat.setNumLinesPerSplit(this.job,numTasksPerMapper);
    }
  }
  mrJobSetupTimer.stop();
}
