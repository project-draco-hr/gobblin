{
  Path jarFileDir=new Path(this.mrJobDir,"_jars");
  if (jobProps.containsKey(ConfigurationKeys.FRAMEWORK_JAR_FILES_KEY)) {
    addJars(jarFileDir,jobProps.getProperty(ConfigurationKeys.FRAMEWORK_JAR_FILES_KEY));
  }
  if (jobProps.containsKey(ConfigurationKeys.JOB_JAR_FILES_KEY)) {
    addJars(jarFileDir,jobProps.getProperty(ConfigurationKeys.JOB_JAR_FILES_KEY));
  }
  if (jobProps.containsKey(ConfigurationKeys.JOB_LOCAL_FILES_KEY)) {
    addLocalFiles(new Path(this.mrJobDir,"_files"),jobProps.getProperty(ConfigurationKeys.JOB_LOCAL_FILES_KEY));
  }
  if (jobProps.containsKey(ConfigurationKeys.JOB_HDFS_FILES_KEY)) {
    addHDFSFiles(jobProps.getProperty(ConfigurationKeys.JOB_HDFS_FILES_KEY));
  }
  this.job=Job.getInstance(this.conf,JOB_NAME_PREFIX + jobName);
  this.job.setJarByClass(MRJobLauncher.class);
  this.job.setMapperClass(TaskRunner.class);
  this.job.setNumReduceTasks(0);
  this.job.setInputFormatClass(NLineInputFormat.class);
  this.job.setOutputFormatClass(GobblinOutputFormat.class);
  this.job.setMapOutputKeyClass(NullWritable.class);
  this.job.setMapOutputValueClass(NullWritable.class);
  this.job.setSpeculativeExecution(false);
  Path jobInputPath=new Path(this.mrJobDir,"input");
  Path jobInputFile=prepareJobInput(jobInputPath,workUnits);
  NLineInputFormat.addInputPath(this.job,jobInputFile);
  Path jobOutputPath=new Path(this.mrJobDir,"output");
  SequenceFileOutputFormat.setOutputPath(this.job,jobOutputPath);
  if (jobProps.containsKey(ConfigurationKeys.MR_JOB_MAX_MAPPERS_KEY)) {
    int maxMappers=Integer.parseInt(jobProps.getProperty(ConfigurationKeys.MR_JOB_MAX_MAPPERS_KEY));
    if (workUnits.size() > maxMappers) {
      int numTasksPerMapper=workUnits.size() % maxMappers == 0 ? workUnits.size() / maxMappers : workUnits.size() / maxMappers + 1;
      NLineInputFormat.setNumLinesPerSplit(this.job,numTasksPerMapper);
    }
  }
  return jobOutputPath;
}
