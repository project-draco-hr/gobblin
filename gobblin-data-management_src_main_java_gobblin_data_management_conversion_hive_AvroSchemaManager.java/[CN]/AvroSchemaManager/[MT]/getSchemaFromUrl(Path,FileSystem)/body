{
  URI uri=schemaUrl.toUri();
  String scheme=(null != uri && null != uri.getScheme()) ? uri.getScheme().toLowerCase() : "hdfs";
switch (scheme) {
case "http":
case "https":
    String schemaString=IOUtils.toString(schemaUrl.toUri(),StandardCharsets.UTF_8);
  return HiveAvroORCQueryUtils.readSchemaFromString(schemaString);
default :
return AvroUtils.parseSchemaFromFile(schemaUrl,fs);
}
}
