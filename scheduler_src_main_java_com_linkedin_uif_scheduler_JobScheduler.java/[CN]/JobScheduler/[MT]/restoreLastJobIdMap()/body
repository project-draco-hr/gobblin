{
  FileSystem fs=FileSystem.get(URI.create(this.properties.getProperty(ConfigurationKeys.FS_URI_KEY)),new Configuration());
  Path previousJobIdFileDir=new Path(this.properties.getProperty(ConfigurationKeys.PREVIOUS_JOB_ID_FILE_DIR));
  FileStatus[] stauses=fs.listStatus(previousJobIdFileDir);
  if (stauses == null || stauses.length == 0) {
    return;
  }
  LOG.info("Restoring the mapping between jobs and IDs of their last runs");
  for (  FileStatus status : stauses) {
    String jobName=status.getPath().getName();
    String lastJobId;
    Closer closer=Closer.create();
    try {
      Path previousJobIdFile=new Path(previousJobIdFileDir,jobName);
      InputStream is=closer.register(fs.open(previousJobIdFile));
      InputStreamReader isr=closer.register(new InputStreamReader(is));
      BufferedReader bw=closer.register(new BufferedReader(isr));
      lastJobId=bw.readLine().trim();
    }
  finally {
      closer.close();
    }
    if (Strings.isNullOrEmpty(lastJobId)) {
      LOG.warn("No previous job ID found for job " + jobName);
      continue;
    }
    LOG.info(String.format("Restored previous job ID %s for job %s",lastJobId,jobName));
    this.lastJobIdMap.put(jobName,lastJobId);
  }
}
