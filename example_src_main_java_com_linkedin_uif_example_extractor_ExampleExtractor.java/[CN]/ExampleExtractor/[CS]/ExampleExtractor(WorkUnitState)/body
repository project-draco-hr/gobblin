{
  Schema schema=new Schema.Parser().parse(AVRO_SCHEMA);
  Path sourceFile=new Path(workUnitState.getWorkunit().getProp(SOURCE_FILE_KEY));
  log.info("Reading from source file " + sourceFile);
  DatumReader<GenericRecord> datumReader=new GenericDatumReader<GenericRecord>(schema);
  try {
    URI uri=URI.create(workUnitState.getProp(ConfigurationKeys.FS_URI_KEY,ConfigurationKeys.LOCAL_FS_URI));
    FileSystem fs=FileSystem.get(uri,new Configuration());
    fs.makeQualified(sourceFile);
    this.dataFileReader=new DataFileReader<GenericRecord>(new FsInput(sourceFile,new Configuration()),datumReader);
  }
 catch (  IOException ioe) {
    log.error("Failed to read the source file " + sourceFile,ioe);
  }
}
