{
  _curRequest=onNewRecord(record,_curRequest);
  if (_curRequest.isPresent()) {
    ListenableFuture<HttpResponse> responseFuture=sendRequest(_curRequest.get());
    waitForResponse(responseFuture);
    try {
      processResponse(responseFuture.get());
    }
 catch (    InterruptedException|ExecutionException e) {
      throw new RuntimeException(e);
    }
  }
}
