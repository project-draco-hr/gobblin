{
  ContextAwareHistogram jobRecordSizeDist=this.context.contextAwareHistogram(RECORD_SIZE_DISTRIBUTION);
  Assert.assertEquals(this.context.getHistograms().get(MetricRegistry.name(this.context.metricNamePrefix(),jobRecordSizeDist.getName())),jobRecordSizeDist);
  Assert.assertEquals(jobRecordSizeDist.getContext(),this.context);
  Assert.assertEquals(jobRecordSizeDist.getName(),RECORD_SIZE_DISTRIBUTION);
  Assert.assertTrue(jobRecordSizeDist.getTags().isEmpty());
  jobRecordSizeDist.addTag(new Tag<String>(METRIC_GROUP_KEY,INPUT_RECORDS_GROUP));
  Assert.assertEquals(jobRecordSizeDist.getTags().size(),1);
  Assert.assertEquals(jobRecordSizeDist.getTags().get(0).getKey(),METRIC_GROUP_KEY);
  Assert.assertEquals(jobRecordSizeDist.getTags().get(0).getValue(),INPUT_RECORDS_GROUP);
  Assert.assertEquals(jobRecordSizeDist.getFullyQualifiedName(),MetricRegistry.name(INPUT_RECORDS_GROUP,RECORD_SIZE_DISTRIBUTION));
  jobRecordSizeDist.update(2);
  jobRecordSizeDist.update(4);
  jobRecordSizeDist.update(7);
  Assert.assertEquals(jobRecordSizeDist.getCount(),3l);
  Assert.assertEquals(jobRecordSizeDist.getSnapshot().getMin(),2l);
  Assert.assertEquals(jobRecordSizeDist.getSnapshot().getMax(),7l);
  Assert.assertEquals(jobRecordSizeDist.getSnapshot().getMedian(),4d);
  ContextAwareHistogram taskRecordSizeDist=this.childContext.contextAwareHistogram(RECORD_SIZE_DISTRIBUTION);
  Assert.assertEquals(this.childContext.getHistograms().get(MetricRegistry.name(this.childContext.metricNamePrefix(),taskRecordSizeDist.getName())),taskRecordSizeDist);
  Assert.assertEquals(taskRecordSizeDist.getContext(),this.childContext);
  Assert.assertEquals(taskRecordSizeDist.getName(),RECORD_SIZE_DISTRIBUTION);
  taskRecordSizeDist.update(3);
  taskRecordSizeDist.update(14);
  taskRecordSizeDist.update(11);
  Assert.assertEquals(taskRecordSizeDist.getCount(),3l);
  Assert.assertEquals(taskRecordSizeDist.getSnapshot().getMin(),3l);
  Assert.assertEquals(taskRecordSizeDist.getSnapshot().getMax(),14l);
  Assert.assertEquals(taskRecordSizeDist.getSnapshot().getMedian(),11d);
  Assert.assertEquals(jobRecordSizeDist.getCount(),6l);
  Assert.assertEquals(jobRecordSizeDist.getSnapshot().getMin(),2l);
  Assert.assertEquals(jobRecordSizeDist.getSnapshot().getMax(),14l);
  Assert.assertEquals(jobRecordSizeDist.getSnapshot().getMedian(),(4d + 7d) / 2);
}
