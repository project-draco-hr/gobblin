{
  super.updateTaskMetrics();
  WorkUnit workUnit=this.task.getTaskState().getWorkunit();
  if (GobblinMetrics.isEnabled(workUnit)) {
    TaskMetrics metrics=TaskMetrics.get(this.task.getTaskState());
    if (workUnit.getPropAsBoolean(ConfigurationKeys.MR_INCLUDE_TASK_COUNTERS_KEY,ConfigurationKeys.DEFAULT_MR_INCLUDE_TASK_COUNTERS)) {
      Map<String,? extends Metric> taskLevelCounters=metrics.getMetricContext().getCounters();
      for (      Map.Entry<String,? extends Metric> entry : taskLevelCounters.entrySet()) {
        this.context.getCounter(MetricGroup.TASK.name(),entry.getKey()).setValue(((Counter)entry.getValue()).getCount());
      }
    }
  }
  this.context.progress();
}
