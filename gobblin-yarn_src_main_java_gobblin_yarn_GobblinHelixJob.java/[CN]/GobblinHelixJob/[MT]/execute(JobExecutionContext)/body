{
  JobDataMap dataMap=context.getJobDetail().getJobDataMap();
  JobScheduler jobScheduler=(JobScheduler)dataMap.get(JobScheduler.JOB_SCHEDULER_KEY);
  Properties jobProps=(Properties)dataMap.get(JobScheduler.PROPERTIES_KEY);
  JobListener jobListener=(JobListener)dataMap.get(JobScheduler.JOB_LISTENER_KEY);
  HelixManager helixManager=(HelixManager)dataMap.get(GobblinHelixJobScheduler.HELIX_MANAGER_KEY);
  Path appWorkDir=(Path)dataMap.get(GobblinHelixJobScheduler.APPLICATION_WORK_DIR_KEY);
  @SuppressWarnings("unchecked") Map<String,String> eventMetadata=(Map<String,String>)dataMap.get(GobblinHelixJobScheduler.EVENT_METADATA);
  FileSystem fs=(FileSystem)dataMap.get(GobblinHelixJobScheduler.FILE_SYSTEM);
  try {
    JobLauncher jobLauncher=new GobblinHelixJobLauncher(jobProps,helixManager,fs,appWorkDir,eventMetadata);
    jobScheduler.runJob(jobProps,jobListener,jobLauncher);
  }
 catch (  Throwable t) {
    throw new JobExecutionException(t);
  }
}
