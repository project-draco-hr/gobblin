{
  State jobProps=new State();
  jobProps.addAll(this.state);
  jobProps.setProp(ConfigurationKeys.COMPACTION_TOPIC,this.topic);
  jobProps.setProp(ConfigurationKeys.COMPACTION_JOB_INPUT_DIR,jobInputDir);
  jobProps.setProp(ConfigurationKeys.COMPACTION_JOB_DEST_DIR,jobOutputDir);
  jobProps.setProp(ConfigurationKeys.COMPACTION_JOB_TMP_DIR,jobTmpDir);
  LOG.info(String.format("Created MR job properties for input %s and output %s.",jobInputDir,jobOutputDir));
  if (!fs.exists(jobOutputDir)) {
    return Optional.of(jobProps);
  }
 else   if (forceReprocess()) {
    LOG.info(String.format("Outout dir %s for topic %s exists, force reprocess = true. Reprocessing.",topic,jobOutputDir));
    return Optional.of(jobProps);
  }
 else {
    LOG.info(String.format("Outout dir %s for topic %s exists, force reprocess = false. Skipping.",topic,jobOutputDir));
    return Optional.absent();
  }
}
