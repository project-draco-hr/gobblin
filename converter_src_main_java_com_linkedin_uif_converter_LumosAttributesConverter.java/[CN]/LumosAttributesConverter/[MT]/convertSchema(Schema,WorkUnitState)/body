{
  SchemaAttributes att=new SchemaAttributes(inputSchema);
  Extract extract=workUnit.getExtract();
  att.setTableType(TableType.valueOf(extract.getType().toString()));
  att.setDropDate(extract.getExtractId());
  if (extract.getIsFull()) {
    att.isFull(true);
    att.setFullDropDate(extract.getFullExtractRunTime());
    att.setBeginDate(extract.getFullExtractRunTime());
  }
  if (extract.getIsSharded()) {
    att.isSharded(true);
    att.setRealDbName(extract.getShardedRealNameSpace());
  }
  if (extract.getIsSecured()) {
    att.isSecured(true);
    att.setPermissionGroup(extract.getSecurityPermissionGroup());
  }
  if (extract.getValidationRecordCount() != -1) {
    att.setValidationCount(extract.getValidationRecordCount());
    att.setValidationHighWater(extract.getValidationRecordCountHighWaterMark());
  }
switch (extract.getType()) {
case SNAPSHOT_APPEND:
    att.setPrimaryKeyFields(extract.getPrimaryKeys());
case APPEND_ONLY:
  att.setDeltaFields(extract.getDeltaFields());
break;
case SNAPSHOT_ONLY:
att.isFull(true);
att.setFullDropDate(extract.getFullExtractRunTime());
}
return att.getSchema();
}
