{
  String dbName="testdb3";
  String tableName="testtable3";
  String tableSdLoc="/tmp/testtable3";
  this.localMetastoreClient.dropDatabase(dbName,false,true,true);
  SourceState testState=getTestState(dbName);
  Table tbl=createTestTable(dbName,tableName,tableSdLoc,Optional.of("field"));
  addTestPartition(tbl,ImmutableList.of("f1"));
  this.updateProvider.addMockUpdateTime("testdb3@testtable3@field=f1",2);
  List<WorkUnit> workUnits=this.hiveSource.getWorkunits(testState);
  Assert.assertEquals(workUnits.size(),1);
  WorkUnit wu=workUnits.get(0);
  SerializableHiveTable serializedHiveTable=HiveSourceUtils.deserializeTable(wu);
  SerializableHivePartition serializedHivePartition=HiveSourceUtils.deserializePartition(wu);
  Assert.assertEquals(serializedHiveTable.getDbName(),dbName);
  Assert.assertEquals(serializedHiveTable.getTableName(),tableName);
  Assert.assertEquals(serializedHivePartition.getPartitionName(),"field=f1");
}
