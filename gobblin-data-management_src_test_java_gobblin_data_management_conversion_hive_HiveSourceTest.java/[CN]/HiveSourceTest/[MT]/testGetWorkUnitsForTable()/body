{
  String dbName="testdb2";
  String tableName="testtable2";
  String tableSdLoc="/tmp/testtable2";
  this.hiveMetastoreTestUtils.getLocalMetastoreClient().dropDatabase(dbName,false,true,true);
  SourceState testState=getTestState(dbName);
  this.hiveMetastoreTestUtils.createTestTable(dbName,tableName,tableSdLoc,Optional.<String>absent());
  List<WorkUnit> workUnits=hiveSource.getWorkunits(testState);
  Assert.assertEquals(workUnits.size(),1);
  WorkUnit wu=workUnits.get(0);
  HiveWorkUnit hwu=new HiveWorkUnit(wu);
  Assert.assertEquals(hwu.getHiveDataset().getDbAndTable().getDb(),dbName);
  Assert.assertEquals(hwu.getHiveDataset().getDbAndTable().getTable(),tableName);
  Assert.assertEquals(hwu.getTableSchemaUrl(),new Path("/tmp/dummy"));
}
