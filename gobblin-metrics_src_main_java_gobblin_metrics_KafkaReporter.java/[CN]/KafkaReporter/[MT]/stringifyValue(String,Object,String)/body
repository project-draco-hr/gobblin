{
  Metric metric=new Metric();
  metric.name=makeName(name,path);
  metric.value=value;
  metric.env=env;
  metric.tags=tags;
  metric.host=host;
  metric.timestamp=System.currentTimeMillis();
  try {
    return mapper.writeValueAsString(metric);
  }
 catch (  Exception e) {
    LOGGER.trace("Could not serialize Avro record for Kafka Metrics. Exception: %s",e.getMessage());
    if (System.currentTimeMillis() - lastSerializeExceptionTime > 10000) {
      LOGGER.warn("Could not serialize Avro record for Kafka Metrics. Exception: %s",e.getMessage());
      lastSerializeExceptionTime=System.currentTimeMillis();
    }
  }
  return null;
}
