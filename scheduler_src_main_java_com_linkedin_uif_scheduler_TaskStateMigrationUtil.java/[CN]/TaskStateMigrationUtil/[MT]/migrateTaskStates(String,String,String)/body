{
  StateStore srcStore=new FsStateStore(fsUri,srcDir,TaskState.class);
  StateStore destStore=new FsStateStore(fsUri,destDir,com.linkedin.uif.runtime.TaskState.class);
  FileSystem fs=FileSystem.get(URI.create(fsUri),new Configuration());
  FileStatus[] stores=fs.listStatus(new Path(srcDir));
  if (stores == null || stores.length == 0) {
    System.out.println("No task states to migrate");
    return;
  }
  for (  FileStatus store : stores) {
    String storeName=store.getPath().getName();
    FileStatus[] tables=fs.listStatus(store.getPath(),new PathFilter(){
      @Override public boolean accept(      Path path){
        return path.getName().endsWith(".tst");
      }
    }
);
    if (tables == null || tables.length == 0) {
      System.out.println("No task states in store " + storeName);
      continue;
    }
    sortFileStatuses(tables);
    destStore.createAlias(storeName,tables[0].getPath().getName(),"current" + ".tst");
    for (    FileStatus table : tables) {
      String tableName=table.getPath().getName();
      List<TaskState> srcTaskStates=(List<TaskState>)srcStore.getAll(storeName,tableName);
      destStore.putAll(storeName,tableName,createNewTaskStates(srcTaskStates));
    }
  }
}
