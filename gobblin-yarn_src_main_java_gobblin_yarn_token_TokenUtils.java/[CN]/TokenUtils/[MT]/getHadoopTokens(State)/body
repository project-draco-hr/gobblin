{
  Preconditions.checkArgument(state.contains(USER_TO_PROXY),"Missing required property " + USER_TO_PROXY);
  Preconditions.checkArgument(state.contains(KEYTAB_USER),"Missing required property " + KEYTAB_USER);
  Preconditions.checkArgument(state.contains(KEYTAB_LOCATION),"Missing required property " + KEYTAB_LOCATION);
  UserGroupInformation.loginUserFromKeytab(state.getProp(KEYTAB_USER),state.getProp(KEYTAB_LOCATION));
  final String userToProxy=state.getProp(USER_TO_PROXY);
  final Configuration conf=new Configuration();
  final Credentials cred=new Credentials();
  LOG.info("Getting tokens for " + userToProxy);
  getJhToken(conf,userToProxy,cred);
  getFsAndJtTokens(state,conf,userToProxy,cred);
  persisteTokens(cred);
}
