{
  Set<String> targetDataTypes=ImmutableSet.<String>builder().add("DATE").add("DATETIME").add("TIME").add("TIMESTAMP").build();
  final String SELECT_SQL_PSTMT="SELECT column_name, column_type FROM information_schema.columns where table_name = ?";
  String table=Objects.requireNonNull(state.getProp(ConfigurationKeys.JDBC_PUBLISHER_FINAL_TABLE_NAME));
  ImmutableSet.Builder<String> dateColumnsBuilder=ImmutableSet.builder();
  try (PreparedStatement pstmt=conn.prepareStatement(SELECT_SQL_PSTMT)){
    pstmt.setString(1,table);
    ResultSet rs=pstmt.executeQuery();
    if (!rs.first()) {
      throw new IllegalArgumentException("No result from information_schema.columns");
    }
    do {
      String type=rs.getString("column_type").toUpperCase();
      if (targetDataTypes.contains(type)) {
        dateColumnsBuilder.add(rs.getString("column_name").toUpperCase());
      }
    }
 while (rs.next());
  }
   return dateColumnsBuilder.build();
}
