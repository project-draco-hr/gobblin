{
  LOG.info("Writing " + record);
  try {
    int i=1;
    for (    Map.Entry<String,Type> entry : flattened.entrySet()) {
      Object val=record.get(entry.getKey());
      if (val != null && dateColumns.contains(entry.getKey().toUpperCase())) {
        LOG.info("Date column detected " + entry.getKey() + " , "+ entry.getValue());
        if (!Type.LONG.equals(entry.getValue())) {
          throw new IllegalArgumentException("Avro data type needs to be long for corresponding date,time,timestamp,datetime data type on JDBC side");
        }
        Long ms=Long.parseLong(val.toString());
        Timestamp ts=new Timestamp(ms);
        insertPstmt.setTimestamp(i++,ts);
        continue;
      }
      insertPstmt.setObject(i++,val == null ? null : val.toString());
    }
    LOG.info("Executing " + insertPstmt);
    insertPstmt.executeUpdate();
    insertPstmt.clearParameters();
  }
 catch (  Exception e) {
    failed=true;
    throw new RuntimeException(e);
  }
}
