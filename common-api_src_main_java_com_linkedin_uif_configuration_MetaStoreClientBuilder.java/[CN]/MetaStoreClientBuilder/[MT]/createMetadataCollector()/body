{
  MetaStoreClient metaStoreClient;
  String metaStoreClientString=this.state.getProp(ConfigurationKeys.QUALITY_CHECKER_PREFIX + ConfigurationKeys.METADATA_CLIENT);
  try {
    Class<? extends MetaStoreClient> metaStoreClientClass=(Class<? extends MetaStoreClient>)Class.forName(metaStoreClientString);
    Constructor<? extends MetaStoreClient> metaStoreClientConstructor=metaStoreClientClass.getConstructor();
    metaStoreClient=metaStoreClientConstructor.newInstance();
  }
 catch (  Exception e) {
    LOG.error(ConfigurationKeys.QUALITY_CHECKER_PREFIX + ConfigurationKeys.METADATA_CLIENT + " contains a class "+ metaStoreClientString+ " which doesn't extend MetaStoreClient");
    throw e;
  }
  return metaStoreClient;
}
