{
  byte[] bytes=it.next().message();
  Decoder decoder=DecoderFactory.get().binaryDecoder(bytes,null);
  GenericRecord reuse=new GenericData.Record(schema);
  GenericRecord record=reader.read(reuse,decoder);
  KafkaReporter.Metric metric=new KafkaReporter.Metric();
  metric.name=record.get("name").toString();
  metric.value=record.get("value");
  metric.tags=new HashMap<String,String>();
  if (record.get("tags") != null) {
    for (    Map.Entry<Utf8,Utf8> tag : ((HashMap<Utf8,Utf8>)record.get("tags")).entrySet()) {
      metric.tags.put(tag.getKey().toString(),tag.getValue().toString());
    }
  }
  System.out.println(String.format("%s:%s",metric.name,metric.value));
  return metric;
}
