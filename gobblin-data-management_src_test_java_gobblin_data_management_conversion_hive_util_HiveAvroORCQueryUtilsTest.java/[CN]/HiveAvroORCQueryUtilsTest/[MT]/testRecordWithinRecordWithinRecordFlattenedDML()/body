{
  String schemaName="testRecordWithinRecordWithinRecordDDL";
  Schema schema=readSchemaFromJsonFile("recordWithinRecordWithinRecord_nested.json");
  AvroFlattener avroFlattener=new AvroFlattener();
  Schema flattenedSchema=avroFlattener.flatten(schema,true);
  String q=HiveAvroORCQueryUtils.generateTableMappingDML(schema,flattenedSchema,schemaName,schemaName + "_orc",Optional.<String>absent(),Optional.<String>absent(),Optional.<Map<String,String>>absent(),Optional.<Boolean>absent(),Optional.<Boolean>absent());
  Assert.assertEquals(q.trim().replaceAll(" ",""),readQueryFromFile("recordWithinRecordWithinRecord.dml").replaceAll(" ",""));
}
