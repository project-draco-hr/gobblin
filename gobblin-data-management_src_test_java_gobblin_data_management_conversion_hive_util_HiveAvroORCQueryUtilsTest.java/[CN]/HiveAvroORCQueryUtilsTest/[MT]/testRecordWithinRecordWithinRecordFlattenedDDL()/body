{
  String schemaName="testRecordWithinRecordWithinRecordDDL";
  Schema schema=readSchemaFromJsonFile("recordWithinRecordWithinRecord_nested.json");
  AvroFlattener avroFlattener=new AvroFlattener();
  Schema flattenedSchema=avroFlattener.flatten(schema,true);
  String q=HiveAvroORCQueryUtils.generateCreateTableDDL(flattenedSchema,schemaName,"file:/user/hive/warehouse/" + schemaName,Optional.<String>absent(),Optional.<Map<String,String>>absent(),Optional.<List<String>>absent(),Optional.<Map<String,HiveAvroORCQueryUtils.COLUMN_SORT_ORDER>>absent(),Optional.<Integer>absent(),Optional.<String>absent(),Optional.<String>absent(),Optional.<String>absent(),Optional.<Map<String,String>>absent());
  Assert.assertEquals(q.trim().replaceAll(" ",""),readQueryFromFile("recordWithinRecordWithinRecord_flattened.ddl").replaceAll(" ",""));
}
