{
  System.out.println("====Checking for expected messages and values. Will list all messages.====");
  try {
    while (it.hasNext()) {
      KafkaReporter.Metric metric=nextMetric(it);
      if (expected.containsKey(metric.name)) {
        Assert.assertEquals(expected.get(metric.name),Double.parseDouble(metric.value.toString()));
        expected.remove(metric.name);
      }
    }
  }
 catch (  ConsumerTimeoutException e) {
    Assert.assertTrue(expected.isEmpty());
  }
}
