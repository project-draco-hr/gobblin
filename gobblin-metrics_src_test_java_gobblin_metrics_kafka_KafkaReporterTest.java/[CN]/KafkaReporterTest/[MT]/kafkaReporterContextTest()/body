{
  Tag<?> tag1=new Tag<String>("tag1","value1");
  MetricContext context=MetricContext.builder("context").addTag(tag1).build();
  Counter counter=context.counter("com.linkedin.example.counter");
  KafkaReporter kafkaReporter=getBuilderFromContext(context).build("localhost:" + kafkaPort,topic);
  counter.inc();
  kafkaReporter.report();
  try {
    Thread.sleep(100);
  }
 catch (  InterruptedException ex) {
    Thread.currentThread().interrupt();
  }
  KafkaReporter.Metric metric=nextMetric(iterator);
  Assert.assertEquals(1,Integer.parseInt(metric.value.toString()));
  Assert.assertEquals(1,metric.tags.size());
  Assert.assertTrue(metric.tags.containsKey(tag1.getKey()));
  Assert.assertEquals(metric.tags.get(tag1.getKey()),tag1.getValue().toString());
}
