{
  DataPublisher publisher=new HDFSDataPublisher(taskStates.get(0));
  publisher.initialize();
  publisher.publishData(taskStates);
  LOG.info("Persisting task states of job " + jobId);
  this.taskStateStore.putAll(jobName,jobId,taskStates);
  this.jobSourceMap.remove(jobId);
  this.jobTaskCountMap.remove(jobId);
  this.jobTaskStatesMap.remove(jobId);
  this.lastJobIdMap.put(jobName,jobId);
  this.jobLockMap.get(jobName).unlock();
}
