{
  if (!this.properties.contains(TIME_PARTITIONED_WRITER_MAX_TIME_AGO)) {
    return Optional.<Long>absent();
  }
 else {
    DateTime currentTime=new DateTime(this.timeZone);
    PeriodFormatter periodFormatter=getPeriodFormatter();
    String maxTimeAgoStr=this.properties.getProp(TIME_PARTITIONED_WRITER_MAX_TIME_AGO);
    Period maxTimeAgo=periodFormatter.parsePeriod(maxTimeAgoStr);
    return Optional.of(currentTime.minus(maxTimeAgo).getMillis());
  }
}
