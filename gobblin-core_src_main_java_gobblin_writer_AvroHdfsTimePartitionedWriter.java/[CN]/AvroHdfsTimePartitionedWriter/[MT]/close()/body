{
  this.properties.setProp(ConfigurationKeys.WRITER_RECORDS_WRITTEN,recordsWritten());
  this.properties.setProp(ConfigurationKeys.WRITER_BYTES_WRITTEN,bytesWritten());
  this.properties.setProp(ConfigurationKeys.WRITER_EARLIEST_TIMESTAMP,this.earliestTimestampWritten);
  this.properties.setProp(ConfigurationKeys.WRITER_AVERAGE_TIMESTAMP,(long)(this.totalTimestampWritten / recordsWritten()));
  boolean closeFailed=false;
  for (  Entry<Path,FsDataWriter<GenericRecord>> entry : this.pathToWriterMap.entrySet()) {
    try {
      this.properties.appendToListProp(ConfigurationKeys.WRITER_FINAL_OUTPUT_FILE_PATHS,entry.getValue().getOutputFilePath());
      entry.getValue().close();
    }
 catch (    IOException e) {
      closeFailed=true;
      LOG.error("Failed to close writer for path: " + entry.getKey(),e);
    }
  }
  if (closeFailed) {
    throw new IOException("Failed to close all writers");
  }
}
