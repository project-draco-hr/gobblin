{
  Optional<Object> writerPartitionColumnValue=AvroUtils.getFieldValue(record,this.partitionColumnName);
  long recordTimestamp=writerPartitionColumnValue.get() instanceof Long ? (Long)writerPartitionColumnValue.get() : System.currentTimeMillis();
  Path writerOutputPath=getPathForColumnValue(recordTimestamp);
  if (!this.pathToWriterMap.containsKey(writerOutputPath)) {
    LOG.info("Creating a new DataWriter for path: " + new Path(this.baseFilePath,writerOutputPath));
    DataWriter<GenericRecord> avroHdfsDataWriter=createAvroHdfsDataWriterForPath(writerOutputPath);
    this.pathToWriterMap.put(writerOutputPath,avroHdfsDataWriter);
  }
  this.pathToWriterMap.get(writerOutputPath).write(record);
}
