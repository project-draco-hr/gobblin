{
  Path writerOutputPath=getPathForColumnValue(recordTimestamp);
  if (!this.pathToWriterMap.containsKey(writerOutputPath)) {
    LOG.info("Creating a new DataWriter for path: " + writerOutputPath);
    FsDataWriter<GenericRecord> avroHdfsDataWriter=createAvroHdfsDataWriterForPath(writerOutputPath);
    this.pathToWriterMap.put(writerOutputPath,avroHdfsDataWriter);
  }
  this.pathToWriterMap.get(writerOutputPath).write(record);
  this.earliestTimestampWritten=Math.min(this.earliestTimestampWritten,recordTimestamp);
  this.totalTimestampWritten+=recordTimestamp;
}
