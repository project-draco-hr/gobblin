{
  writer.write("test");
  Map<String,Long> metrics=MetricsHelper.dumpMetrics(writer.getMetricContext());
  Assert.assertEquals(metrics.get(MetricNames.DataWriter.RECORDS_IN),Long.valueOf(1));
  Assert.assertEquals(metrics.get(MetricNames.DataWriter.RECORDS_WRITTEN),Long.valueOf(1));
  Assert.assertEquals(metrics.get(MetricNames.DataWriter.RECORDS_FAILED),Long.valueOf(0));
  Assert.assertEquals(metrics.get(MetricNames.DataWriter.WRITE_TIME),Long.valueOf(1));
  Assert.assertEquals(MetricsHelper.dumpTags(writer.getMetricContext()).get("construct"),Constructs.WRITER.toString());
}
