{
  try {
    for (    FileStatus status : this.fs.listStatus(path)) {
      if (status.isDir()) {
        Schema schema=getSchema(status.getPath());
        if (schema != null) {
          return schema;
        }
      }
 else       if (FilenameUtils.isExtension(status.getPath().getName().toLowerCase(),AVRO)) {
        return AvroUtils.getSchemaFromDataFile(status.getPath(),this.fs);
      }
    }
    return null;
  }
 catch (  IOException e) {
    log.error("Unable to get schema from " + path,e);
    throw Throwables.propagate(e);
  }
}
