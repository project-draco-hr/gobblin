{
  Preconditions.checkNotNull(this.destination);
  Preconditions.checkArgument(!Strings.isNullOrEmpty(this.writerId));
  Preconditions.checkNotNull(this.schema);
  Preconditions.checkArgument(this.format == WriterOutputFormat.AVRO);
switch (this.destination.getType()) {
case HDFS:
    return new AvroHdfsDatePartitionedWriter(this.destination,this.writerId,this.schema,this.format,this.branch);
case KAFKA:
  throw new UnsupportedOperationException("The builder " + this.getClass().getName() + " cannot write to "+ this.destination.getType());
default :
throw new RuntimeException("Unknown destination type: " + this.destination.getType());
}
}
