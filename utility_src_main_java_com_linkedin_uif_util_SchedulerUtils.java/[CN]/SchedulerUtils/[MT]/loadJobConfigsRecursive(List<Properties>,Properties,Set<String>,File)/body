{
  String[] propertiesFiles=jobConfigDir.list(new FilenameFilter(){
    @Override public boolean accept(    File file,    String name){
      return name.toLowerCase().endsWith(JOB_PROPS_FILE_EXTENSION);
    }
  }
);
  if (propertiesFiles != null && propertiesFiles.length > 0) {
    if (propertiesFiles.length != 1) {
      throw new RuntimeException("Found more than one .properties files in directory: " + jobConfigDir);
    }
    rootProps.load(new FileReader(new File(jobConfigDir,propertiesFiles[0])));
  }
  String[] names=jobConfigDir.list();
  for (  String name : names) {
    File file=new File(jobConfigDir,name);
    if (file.isDirectory()) {
      Properties rootPropsCopy=new Properties();
      rootPropsCopy.putAll(rootProps);
      loadJobConfigsRecursive(jobConfigs,rootPropsCopy,jobConfigFileExtensions,file);
    }
 else {
      int pos=file.getName().lastIndexOf(".");
      String fileExtension=pos >= 0 ? file.getName().substring(pos + 1) : "";
      if (!jobConfigFileExtensions.contains(fileExtension)) {
        continue;
      }
      Properties jobProps=new Properties();
      jobProps.putAll(rootProps);
      jobProps.load(new FileReader(file));
      jobProps.setProperty(ConfigurationKeys.JOB_CONFIG_FILE_PATH_KEY,file.getAbsolutePath());
      jobConfigs.add(jobProps);
    }
  }
}
