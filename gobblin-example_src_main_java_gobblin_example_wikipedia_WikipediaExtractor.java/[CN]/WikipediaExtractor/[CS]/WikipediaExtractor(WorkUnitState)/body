{
  this.workUnit=workUnitState.getWorkunit();
  this.rootUrl=this.workUnit.getProp(WIKIPEDIA_API_ROOTURL);
  this.schema=this.workUnit.getProp(WIKIPEDIA_AVRO_SCHEMA);
  this.requestedTitles=new LinkedList<String>(SPLITTER.splitToList(this.workUnit.getProp(SOURCE_PAGE_TITLES)));
  this.revisionsCnt=Integer.parseInt(this.workUnit.getProp(SOURCE_REVISIONS_CNT));
  this.numRequestedTitles=this.requestedTitles.size();
  if (this.requestedTitles.isEmpty()) {
    this.recordsOfCurrentTitle=new LinkedList<JsonElement>();
  }
 else {
    String firstTitle=this.requestedTitles.poll();
    this.recordsOfCurrentTitle=retrievePageRevisions(firstTitle);
  }
  this.reader=new WikiResponseReader();
}
