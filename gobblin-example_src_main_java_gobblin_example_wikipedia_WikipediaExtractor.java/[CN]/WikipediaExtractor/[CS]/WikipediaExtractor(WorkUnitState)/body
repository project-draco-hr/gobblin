{
  LOG.info("WorkUnitState received: " + workUnitState);
  this.workUnitState=workUnitState;
  this.workUnit=workUnitState.getWorkunit();
  this.rootUrl=readProp(WIKIPEDIA_API_ROOTURL,workUnitState);
  this.schema=readProp(WIKIPEDIA_AVRO_SCHEMA,workUnitState);
  this.requestedTitles=new LinkedList<>(SPLITTER.splitToList(readProp(SOURCE_PAGE_TITLES,workUnitState)));
  this.revisionsCnt=Integer.parseInt(readProp(SOURCE_REVISIONS_CNT,workUnitState));
  this.numRequestedTitles=this.requestedTitles.size();
  if (this.requestedTitles.isEmpty()) {
    this.recordsOfCurrentTitle=new LinkedList<>();
  }
 else {
    String firstTitle=this.requestedTitles.poll();
    this.recordsOfCurrentTitle=retrievePageRevisions(firstTitle);
  }
  this.reader=new WikiResponseReader();
}
