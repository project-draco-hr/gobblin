{
  try {
    Path workUnitFilePath=new Path(this.taskConfig.getConfigMap().get(GobblinYarnConfigurationKeys.WORK_UNIT_FILE_PATH));
    WorkUnit workUnit=workUnitFilePath.getName().endsWith(AbstractJobLauncher.MULTI_WORK_UNIT_FILE_EXTENSION) ? MultiWorkUnit.createEmpty() : WorkUnit.createEmpty();
    SerializationUtils.deserializeState(this.fs,workUnitFilePath,workUnit);
    List<WorkUnit> workUnits=Lists.newArrayList();
    if (workUnit instanceof MultiWorkUnit) {
      List<WorkUnit> flattenedWorkUnits=JobLauncherUtils.flattenWorkUnits(((MultiWorkUnit)workUnit).getWorkUnits());
      for (      WorkUnit flattenedWorkUnit : flattenedWorkUnits) {
        flattenedWorkUnit.addAllIfNotExist(this.jobState);
      }
      workUnits.addAll(flattenedWorkUnits);
    }
 else {
      workUnit.addAllIfNotExist(this.jobState);
      workUnits.add(workUnit);
    }
    runWorkUnits(workUnits);
    return new TaskResult(TaskResult.Status.COMPLETED,String.format("completed tasks: %d",workUnits.size()));
  }
 catch (  IOException ioe) {
    return new TaskResult(TaskResult.Status.ERROR,Throwables.getStackTraceAsString(ioe));
  }
catch (  InterruptedException ie) {
    Thread.currentThread().interrupt();
    return new TaskResult(TaskResult.Status.CANCELED,"");
  }
catch (  Throwable t) {
    return new TaskResult(TaskResult.Status.ERROR,Throwables.getStackTraceAsString(t));
  }
}
