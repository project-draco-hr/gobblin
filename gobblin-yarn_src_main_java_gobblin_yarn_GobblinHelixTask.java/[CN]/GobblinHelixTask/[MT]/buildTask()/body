{
  Path workUnitFilePath=new Path(this.taskConfig.getConfigMap().get(GobblinYarnConfigurationKeys.WORK_UNIT_FILE_PATH));
  WorkUnit workUnit=workUnitFilePath.getName().endsWith(AbstractJobLauncher.MULTI_WORK_UNIT_FILE_EXTENSION) ? MultiWorkUnit.createEmpty() : WorkUnit.createEmpty();
  SerializationUtils.deserializeState(this.fs,workUnitFilePath,workUnit);
  workUnit.addAllIfNotExist(this.jobState);
  WorkUnitState workUnitState=new WorkUnitState(workUnit);
  workUnitState.setId(this.taskId);
  workUnitState.setProp(ConfigurationKeys.JOB_ID_KEY,this.jobId);
  workUnitState.setProp(ConfigurationKeys.TASK_ID_KEY,this.taskId);
  return new gobblin.runtime.Task(new TaskContext(workUnitState),this.taskStateTracker,this.taskExecutor,Optional.<CountDownLatch>absent());
}
