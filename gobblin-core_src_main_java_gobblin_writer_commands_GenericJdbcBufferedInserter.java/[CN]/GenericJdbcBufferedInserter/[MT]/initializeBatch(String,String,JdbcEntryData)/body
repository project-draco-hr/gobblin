{
  List<String> columnNames=Lists.newArrayList();
  for (  JdbcEntryDatum datum : jdbcEntryData) {
    columnNames.add(datum.getColumnName());
  }
  String insertPstmtStr=String.format(INSERT_STATEMENT_PREFIX_FORMAT,databaseName,table,JOINER_ON_COMMA.join(columnNames),JOINER_ON_COMMA.useForNull("?").join(new String[columnNames.size()]));
  LOG.info("Prepared insert statement: " + insertPstmtStr);
  pStmt=conn.prepareStatement(insertPstmtStr);
  int actualBatchSize=Math.min(maxBatchSize,maxParamSize / columnNames.size());
  if (maxBatchSize != actualBatchSize) {
    LOG.info("Changing batch size from " + maxBatchSize + " to "+ actualBatchSize+ " due to # of params limitation "+ maxParamSize+ " , # of columns: "+ columnNames.size());
  }
  maxBatchSize=actualBatchSize;
}
