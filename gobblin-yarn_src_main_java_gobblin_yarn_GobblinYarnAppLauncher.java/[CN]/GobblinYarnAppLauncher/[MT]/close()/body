{
  ExecutorsUtils.shutdownExecutorService(this.applicationStatusMonitor);
  try {
    if (this.applicationId != null && this.yarnClient.getApplicationReport(this.applicationId).getYarnApplicationState() == YarnApplicationState.RUNNING) {
      this.yarnClient.killApplication(this.applicationId);
    }
  }
 catch (  YarnException ye) {
    LOGGER.error("Failed to kill the Yarn application " + this.applicationId);
  }
 finally {
    this.yarnClient.stop();
  }
}
