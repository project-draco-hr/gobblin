{
  this.eventBus.register(this);
  String clusterName=this.config.getString(GobblinYarnConfigurationKeys.HELIX_CLUSTER_NAME_KEY);
  YarnHelixUtils.createGobblinYarnHelixCluster(this.config.getString(GobblinYarnConfigurationKeys.ZK_CONNECTION_STRING_KEY),clusterName);
  LOGGER.info("Created Helix cluster " + clusterName);
  connectHelixManager();
  this.applicationId=getApplicationId();
  this.applicationStatusMonitor.scheduleAtFixedRate(new Runnable(){
    @Override public void run(){
      try {
        eventBus.post(new ApplicationReportArrivalEvent(yarnClient.getApplicationReport(applicationId.get())));
      }
 catch (      YarnException|IOException e) {
        LOGGER.error("Failed to get application report for Gobblin Yarn application " + applicationId.get(),e);
      }
    }
  }
,0,this.appReportIntervalMinutes,TimeUnit.MINUTES);
  List<Service> services=Lists.newArrayList();
  if (config.hasPath(GobblinYarnConfigurationKeys.KEYTAB_FILE_PATH)) {
    LOGGER.info("Adding YarnAppSecurityManager since login is keytab based");
    services.add(new YarnAppSecurityManager(config,this.helixManager,this.fs));
  }
  services.add(buildLogCopier(new Path(this.sinkLogRootDir,this.applicationName + Path.SEPARATOR + this.applicationId.get().toString()),YarnHelixUtils.getAppWorkDirPath(this.fs,this.applicationName,this.applicationId.get().toString())));
  this.serviceManager=Optional.of(new ServiceManager(services));
  this.serviceManager.get().startAsync();
}
