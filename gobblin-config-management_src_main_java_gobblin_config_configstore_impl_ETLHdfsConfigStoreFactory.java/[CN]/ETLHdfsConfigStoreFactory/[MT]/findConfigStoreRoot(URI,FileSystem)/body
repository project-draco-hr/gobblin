{
  Path p=new Path(input.getPath());
  while (p != null) {
    if (fs.exists(p)) {
      FileStatus[] fileStatus=fs.listStatus(p);
      for (      FileStatus f : fileStatus) {
        if (!f.isDir() && f.getPath().getName().equals(CONFIG_STORE_NAME)) {
          String parent=f.getPath().getParent().toString();
          try {
            return new URI(parent);
          }
 catch (          URISyntaxException e) {
            e.printStackTrace();
          }
        }
      }
    }
    p=p.getParent();
  }
  throw new ConfigStoreCreationException("Can not find config store root in " + input);
}
