{
  FileSystem fs=new Path(uri.getPath()).getFileSystem(new Configuration());
  if (!uri.getScheme().equals(this.getScheme())) {
    String errMesg=String.format("Input scheme %s does NOT match config store scheme %s",uri.getScheme(),this.getScheme());
    LOG.error(errMesg);
    throw new ConfigStoreCreationException(errMesg);
  }
  try {
    URI adjusted=new URI(getActualScheme(),uri.getAuthority(),uri.getPath(),uri.getQuery(),uri.getFragment());
    URI physical_root=this.findConfigStoreRoot(adjusted,fs);
    URI logical_root=new URI(getScheme(),physical_root.getAuthority(),physical_root.getPath(),physical_root.getQuery(),physical_root.getFragment());
    return new ETLHdfsConfigStore(physical_root,logical_root);
  }
 catch (  URISyntaxException e) {
    LOG.error("got error when constructing uri based on " + uri,e);
    throw new RuntimeException(e);
  }
}
