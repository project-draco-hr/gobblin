{
  jobState.setEndTime(System.currentTimeMillis());
  jobState.setDuration(jobState.getEndTime() - jobState.getStartTime());
  if (jobState.getState() == JobState.RunningState.WORKING) {
    jobState.setState(JobState.RunningState.SUCCESSFUL);
  }
  for (  TaskState taskState : jobState.getTaskStates()) {
    if (taskState.getWorkingState() == WorkUnitState.WorkingState.FAILED) {
      jobState.setState(JobState.RunningState.FAILED);
      break;
    }
  }
  return jobState;
}
