{
  if (diff == 0) {
    return 0;
  }
  long outputInterval=partitionInterval;
  long totalIntervals=(long)Math.ceil((double)diff / (partitionInterval));
  if (totalIntervals > maxIntervals) {
    outputInterval=(long)Math.ceil((double)diff / maxIntervals);
  }
  return outputInterval;
}
