{
  if (diff == 0) {
    return 0;
  }
  long outputInterval=partitionInterval;
  long totalIntervals=DoubleMath.roundToLong((double)diff / partitionInterval,RoundingMode.CEILING);
  if (totalIntervals > maxIntervals) {
    outputInterval=DoubleMath.roundToLong((double)diff / maxIntervals,RoundingMode.CEILING);
  }
  return outputInterval;
}
