{
  int branches=state.getPropAsInt(ConfigurationKeys.FORK_BRANCHES_KEY,1);
  for (int i=0; i < branches; i++) {
    String writerFsUri=state.getProp(ForkOperatorUtils.getPropertyNameForBranch(ConfigurationKeys.WRITER_FILE_SYSTEM_URI,branches,i),ConfigurationKeys.LOCAL_FS_URI);
    FileSystem fs=FileSystem.get(URI.create(writerFsUri),new Configuration());
    Path stagingPath=WriterUtils.getWriterStagingDir(state,branches > 1 ? i : -1);
    if (fs.exists(stagingPath)) {
      logger.info("Cleaning up staging directory " + stagingPath.toUri().getPath());
      fs.delete(stagingPath,true);
    }
    Path outputPath=WriterUtils.getWriterOutputDir(state,branches > 1 ? i : -1);
    if (fs.exists(outputPath)) {
      logger.info("Cleaning up output directory " + outputPath.toUri().getPath());
      fs.delete(outputPath,true);
    }
  }
}
