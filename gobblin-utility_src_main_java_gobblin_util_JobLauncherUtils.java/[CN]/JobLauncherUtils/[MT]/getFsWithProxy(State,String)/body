{
  if (state.getPropAsBoolean(ConfigurationKeys.SHOULD_FS_PROXY_AS_USER,ConfigurationKeys.DEFAULT_SHOULD_FS_PROXY_AS_USER)) {
    try {
      return new ProxiedFileSystemWrapper().getProxiedFileSystem(state,ProxiedFileSystemWrapper.AuthType.KEYTAB,state.getProp(ConfigurationKeys.SUPER_USER_KEY_TAB_LOCATION),writerFsUri);
    }
 catch (    InterruptedException e) {
      throw new IOException(e);
    }
catch (    URISyntaxException e) {
      throw new IOException(e);
    }
  }
 else {
    return FileSystem.get(URI.create(writerFsUri),new Configuration());
  }
}
