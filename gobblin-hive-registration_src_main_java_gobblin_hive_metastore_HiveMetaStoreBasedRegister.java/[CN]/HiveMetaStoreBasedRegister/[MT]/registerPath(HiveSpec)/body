{
  IMetaStoreClient client=borrowClient();
  try {
    Table table=HiveMetaStoreUtils.getTable(spec.getTable());
    createDbIfNotExists(client,table.getDbName());
    Optional<HivePartition> partition=spec.getPartition();
    createOrAlterTable(client,table);
    if (partition.isPresent()) {
      addOrAlterPartition(client,table,HiveMetaStoreUtils.getPartition(partition.get()),spec.getPath());
    }
  }
 catch (  TException e) {
    throw new IOException(e);
  }
 finally {
    this.clientPool.returnObject(client);
  }
}
