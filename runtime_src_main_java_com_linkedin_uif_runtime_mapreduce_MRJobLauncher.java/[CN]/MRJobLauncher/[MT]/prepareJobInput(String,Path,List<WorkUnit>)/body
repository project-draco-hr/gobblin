{
  Closer closer=Closer.create();
  try {
    Path jobInputFile=new Path(jobInputPath,jobId + ".wulist");
    OutputStream os=closer.register(this.fs.create(jobInputFile));
    Writer osw=closer.register(new OutputStreamWriter(os));
    Writer bw=closer.register(new BufferedWriter(osw));
    for (    WorkUnit workUnit : workUnits) {
      Path workUnitFile=new Path(jobInputPath,workUnit.getProp(ConfigurationKeys.TASK_ID_KEY) + ((workUnit instanceof MultiWorkUnit) ? MULTI_WORK_UNIT_FILE_EXTENSION : WORK_UNIT_FILE_EXTENSION));
      os=closer.register(this.fs.create(workUnitFile));
      DataOutputStream dos=closer.register(new DataOutputStream(os));
      workUnit.write(dos);
      bw.write(workUnitFile.toUri().getPath() + "\n");
    }
    return jobInputFile;
  }
  finally {
    closer.close();
  }
}
