{
  String jobName=jobProps.getProperty(ConfigurationKeys.JOB_NAME_KEY);
  if (this.isCancelled || !Optional.fromNullable(this.job).isPresent()) {
    LOG.info(String.format("Job %s has already been cancelled or has not started yet",jobName));
    return;
  }
  try {
    if (!this.job.isComplete()) {
      LOG.info("Killing Hadoop MR job " + this.job.getJobID());
      this.job.killJob();
    }
    this.isCancelled=true;
  }
 catch (  IOException ioe) {
    LOG.error("Failed to kill the Hadoop MR job " + this.job.getJobID(),ioe);
    throw new JobException("Failed to kill the Hadoop MR job " + this.job.getJobID(),ioe);
  }
}
