{
  List<CopyEntity> copyEntities=Lists.newArrayList();
  InputFormat<?,?> inputFormat=getInputFormat(this.table.getSd());
  Collection<Path> sourcePaths=getPaths(inputFormat,this.table.getSd().getLocation());
  Collection<Path> targetExistingPaths=targetTable.isPresent() ? getPaths(inputFormat,targetTable.get().getSd().getLocation()) : Sets.<Path>newHashSet();
  DiffPathSet diffPathSet=diffSourceAndTargetPaths(sourcePaths,targetExistingPaths,Optional.<Partition>absent(),targetFs);
  for (  CopyableFile.Builder builder : getCopyableFilesFromPaths(diffPathSet.filesToCopy,configuration,Optional.<Partition>absent())) {
    copyEntities.add(builder.build());
  }
  return copyEntities;
}
