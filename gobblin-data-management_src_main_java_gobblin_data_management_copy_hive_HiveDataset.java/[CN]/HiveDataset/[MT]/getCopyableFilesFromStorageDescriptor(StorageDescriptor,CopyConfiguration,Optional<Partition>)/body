{
  List<CopyableFile.Builder> builders=Lists.newArrayList();
  List<SourceAndDestination> dataFiles=Lists.newArrayList();
  for (  Path path : parseLocationIntoPaths(storageDescriptor.getLocation())) {
    FileStatus[] statuses=this.fs.globStatus(path);
    if (statuses == null) {
      continue;
    }
    for (    FileStatus status : statuses) {
      if (status.isDir()) {
        for (        FileStatus dataFile : this.fs.listStatus(status.getPath(),new HiddenFilter())) {
          if (!dataFile.isDir()) {
            dataFiles.add(new SourceAndDestination(dataFile,getTargetPath(dataFile,partition)));
          }
        }
      }
 else {
        dataFiles.add(new SourceAndDestination(status,getTargetPath(status,partition)));
      }
    }
  }
  for (  SourceAndDestination sourceAndDestination : dataFiles) {
    FileSystem actualSourceFs=sourceAndDestination.getSource().getPath().getFileSystem(new Configuration());
    builders.add(CopyableFile.fromOriginAndDestination(actualSourceFs,sourceAndDestination.getSource(),sourceAndDestination.getDestination(),configuration));
  }
  return builders;
}
