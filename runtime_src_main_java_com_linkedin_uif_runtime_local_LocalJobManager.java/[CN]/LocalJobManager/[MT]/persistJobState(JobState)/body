{
  JobState.RunningState runningState=jobState.getState();
  if (runningState == JobState.RunningState.PENDING || runningState == JobState.RunningState.RUNNING || runningState == JobState.RunningState.CANCELLED) {
    return;
  }
  String jobName=jobState.getJobName();
  String jobId=jobState.getJobId();
  LOG.info("Persisting job/task states of job " + jobId);
  try {
    this.taskStateStore.putAll(jobName,jobId + TASK_STATE_STORE_TABLE_SUFFIX,jobState.getTaskStates());
    this.jobStateStore.put(jobName,jobId + JOB_STATE_STORE_TABLE_SUFFIX,jobState);
  }
 catch (  IOException ioe) {
    LOG.error("Failed to persist job/task states of job " + jobId,ioe);
  }
}
