{
  Configuration conf=new Configuration();
  this.fs=FileSystem.get(uri,conf);
  this.stagingFile=new Path(stagingDir,fileName);
  if (this.fs.exists(this.stagingFile)) {
    LOG.warn(String.format("Task staging file %s already exists, deleting it",this.stagingFile));
    this.fs.delete(this.stagingFile,false);
  }
  this.outputFile=new Path(outputDir,fileName);
  if (!this.fs.exists(this.outputFile.getParent())) {
    this.fs.mkdirs(this.outputFile.getParent());
  }
  this.dataConverter=dataConverter;
  this.writer=createDatumWriter(schema,this.stagingFile,bufferSize);
}
