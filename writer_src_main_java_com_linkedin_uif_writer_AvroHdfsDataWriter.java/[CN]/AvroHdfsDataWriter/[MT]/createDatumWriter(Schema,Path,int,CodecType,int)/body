{
  if (this.fs.exists(avroFile)) {
    throw new IOException(String.format("File %s already exists",avroFile));
  }
  FSDataOutputStream outputStream=this.fs.create(avroFile,true,bufferSize);
  DataFileWriter<GenericRecord> writer=new DataFileWriter<GenericRecord>(new GenericDatumWriter<GenericRecord>());
switch (codecType) {
case DEFLATE:
    writer.setCodec(CodecFactory.deflateCodec(deflateLevel));
  break;
case SNAPPY:
writer.setCodec(CodecFactory.snappyCodec());
break;
default :
writer.setCodec(CodecFactory.deflateCodec(deflateLevel));
break;
}
return writer.create(schema,outputStream);
}
