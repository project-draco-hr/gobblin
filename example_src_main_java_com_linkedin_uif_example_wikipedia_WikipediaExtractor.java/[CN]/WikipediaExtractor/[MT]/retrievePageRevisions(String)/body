{
  Queue<JsonElement> retrievedRevisions=new LinkedList<JsonElement>();
  Closer closer=Closer.create();
  HttpURLConnection conn=null;
  StringBuilder sb=new StringBuilder();
  String urlStr=rootUrl + "&titles=" + pageTitle+ "&rvlimit="+ revisionsCnt;
  try {
    URL url=new URL(urlStr);
    conn=(HttpURLConnection)url.openConnection();
    BufferedReader br=closer.register(new BufferedReader(new InputStreamReader(conn.getInputStream())));
    String line;
    while ((line=br.readLine()) != null) {
      sb.append(line + "\n");
    }
  }
  finally {
    try {
      closer.close();
    }
 catch (    IOException e) {
      LOG.error("IOException in Closer.close() while retrieving revisions for title '" + pageTitle + "'");
    }
    if (conn != null) {
      conn.disconnect();
    }
  }
  JsonElement jsonElement=GSON.fromJson(sb.toString(),JsonElement.class);
  JsonObject jsonObj=jsonElement.getAsJsonObject();
  if (jsonObj == null || !jsonObj.has("query")) {
    return retrievedRevisions;
  }
  JsonObject queryObj=jsonObj.getAsJsonObject("query");
  if (!queryObj.has("pages")) {
    return retrievedRevisions;
  }
  JsonObject pagesObj=queryObj.getAsJsonObject("pages");
  if (pagesObj.entrySet().isEmpty()) {
    return retrievedRevisions;
  }
  JsonObject pageIdObj=pagesObj.getAsJsonObject(pagesObj.entrySet().iterator().next().getKey());
  if (!pageIdObj.has("revisions")) {
    return retrievedRevisions;
  }
  JsonArray jsonArr=pageIdObj.getAsJsonArray("revisions");
  for (  JsonElement revElement : jsonArr) {
    JsonObject revObj=revElement.getAsJsonObject();
    if (pageIdObj.has("pageid")) {
      revObj.add("pageid",pageIdObj.get("pageid"));
    }
    if (pageIdObj.has("title")) {
      revObj.add("title",pageIdObj.get("title"));
    }
    retrievedRevisions.add((JsonElement)revObj);
  }
  LOG.info(retrievedRevisions.size() + " record(s) retrieved for title " + pageTitle);
  return retrievedRevisions;
}
