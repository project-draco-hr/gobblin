{
  rootUrl=workUnitState.getWorkunit().getProp(WIKIPEDIA_API_ROOTURL);
  schema=workUnitState.getWorkunit().getProp(WIKIPEDIA_AVRO_SCHEMA);
  requestedTitles=new LinkedList<String>(SPLITTER.splitToList(workUnitState.getWorkunit().getProp(SOURCE_PAGE_TITLES)));
  revisionsCnt=Integer.parseInt(workUnitState.getWorkunit().getProp(SOURCE_REVISIONS_CNT));
  numRequestedTitles=requestedTitles.size();
  if (requestedTitles.isEmpty()) {
    recordsOfCurrentTitle=new LinkedList<JsonElement>();
  }
 else {
    String firstTitle=requestedTitles.poll();
    recordsOfCurrentTitle=retrievePageRevisions(firstTitle);
  }
  this.reader=new WikiResponseReader();
}
