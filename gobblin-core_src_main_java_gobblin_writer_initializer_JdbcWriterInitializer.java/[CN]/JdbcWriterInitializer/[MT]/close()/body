{
  LOG.info("Closing " + this.getClass().getSimpleName());
  try (Connection conn=createConnection()){
    JdbcWriterCommands commands=createJdbcWriterCommands(conn);
    if (!createdStagingTables.isEmpty()) {
      for (      String stagingTable : createdStagingTables) {
        LOG.info("Dropping staging table " + createdStagingTables);
        commands.drop(stagingTable);
      }
    }
    if (userCreatedStagingTable != null) {
      LOG.info("Truncating staging table " + userCreatedStagingTable);
      commands.truncate(userCreatedStagingTable);
    }
  }
 catch (  SQLException e) {
    throw new RuntimeException("Failed to close",e);
  }
}
