{
  boolean preserveFileName=workUnitState.getPropAsBoolean(ForkOperatorUtils.getPropertyNameForBranch(ConfigurationKeys.SOURCE_FILEBASED_PRESERVE_FILE_NAME,this.numBranches,branchId),false);
  for (  FileStatus status : this.fss.get(branchId).listStatus(writerOutputDir)) {
    Path finalOutputPath=preserveFileName ? new Path(publisherOutputDir,workUnitState.getProp(ForkOperatorUtils.getPropertyNameForBranch(ConfigurationKeys.DATA_PUBLISHER_FINAL_NAME,this.numBranches,branchId))) : new Path(publisherOutputDir,status.getPath().getName());
    LOG.info(String.format("Moving %s to %s",status.getPath(),finalOutputPath));
    parallelRunner.renamePath(status.getPath(),finalOutputPath,Optional.<String>absent());
  }
}
