{
  ParallelRunner parallelRunner=this.getParallelRunner(this.fss.get(branchId));
  Path writerOutputDir=WriterUtils.getWriterOutputDir(workUnitState,this.numBranches,branchId);
  if (writerOutputPathsMoved.contains(writerOutputDir)) {
    return;
  }
  if (!this.fss.get(branchId).exists(writerOutputDir)) {
    LOG.warn(String.format("Branch %d of WorkUnit %s produced no data",branchId,workUnitState.getId()));
    return;
  }
  Path publisherOutputDir=WriterUtils.getDataPublisherFinalDir(workUnitState,this.numBranches,branchId);
  if (this.fss.get(branchId).exists(publisherOutputDir)) {
    boolean replaceFinalOutputDir=this.getState().getPropAsBoolean(ForkOperatorUtils.getPropertyNameForBranch(ConfigurationKeys.DATA_PUBLISHER_REPLACE_FINAL_DIR,this.numBranches,branchId));
    if (!replaceFinalOutputDir) {
      addWriterOutputToExistingDir(writerOutputDir,publisherOutputDir,workUnitState,branchId,parallelRunner);
      writerOutputPathsMoved.add(writerOutputDir);
      return;
    }
    this.fss.get(branchId).delete(publisherOutputDir,true);
  }
 else {
    Path parentDir=publisherOutputDir.getParent();
    this.fss.get(branchId).mkdirs(parentDir);
  }
  LOG.info(String.format("Moving %s to %s",writerOutputDir,publisherOutputDir));
  parallelRunner.renamePath(writerOutputDir,publisherOutputDir,this.groups.get(branchId));
  writerOutputPathsMoved.add(writerOutputDir);
}
