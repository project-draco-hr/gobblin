{
  LOG.info("Converting schema " + inputSchema);
  try (Connection conn=createConnection(workUnit)){
    Map<String,Type> avroColumnType=flatten(inputSchema);
    String table=Objects.requireNonNull(workUnit.getProp(ConfigurationKeys.JDBC_PUBLISHER_FINAL_TABLE_NAME));
    Map<String,JDBCType> dateColumnMapping=commands.retrieveDateColumns(conn,table);
    LOG.info("Date column mapping: " + dateColumnMapping);
    List<JdbcEntryMetaDatum> jdbcEntryMetaData=Lists.newArrayList();
    for (    Map.Entry<String,Type> avroEntry : avroColumnType.entrySet()) {
      String colName=tryConvertColumn(avroEntry.getKey(),avroToJdbcColPairs);
      JDBCType jdbcType=dateColumnMapping.get(colName);
      if (jdbcType == null) {
        jdbcType=AVRO_TYPE_JDBC_TYPE_MAPPING.get(avroEntry.getValue());
      }
      Objects.requireNonNull(jdbcType,"Failed to convert " + avroEntry + " AVRO_TYPE_JDBC_TYPE_MAPPING: "+ AVRO_TYPE_JDBC_TYPE_MAPPING+ " , dateColumnMapping: "+ dateColumnMapping);
      jdbcEntryMetaData.add(new JdbcEntryMetaDatum(colName,jdbcType));
    }
    JdbcEntrySchema converted=new JdbcEntrySchema(jdbcEntryMetaData);
    LOG.info("Converted schema into " + converted);
    return converted;
  }
 catch (  SQLException e) {
    throw new SchemaConversionException(e);
  }
}
