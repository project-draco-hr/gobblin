{
  Map<String,JDBCType> targetDataTypes=ImmutableMap.<String,JDBCType>builder().put("DATE",JDBCType.DATE).put("DATETIME",JDBCType.TIME).put("TIME",JDBCType.TIME).put("TIMESTAMP",JDBCType.TIMESTAMP).build();
  final String SELECT_SQL_PSTMT="SELECT column_name, column_type FROM information_schema.columns where table_name = ?";
  String table=Objects.requireNonNull(state.getProp(ConfigurationKeys.JDBC_PUBLISHER_FINAL_TABLE_NAME));
  ImmutableMap.Builder<String,JDBCType> dateColumnsBuilder=ImmutableMap.builder();
  try (PreparedStatement pstmt=conn.prepareStatement(SELECT_SQL_PSTMT)){
    pstmt.setString(1,table);
    LOG.info("Retrieving column type information from SQL: " + pstmt);
    ResultSet rs=pstmt.executeQuery();
    if (!rs.first()) {
      throw new IllegalArgumentException("No result from information_schema.columns");
    }
    do {
      String type=rs.getString("column_type").toUpperCase();
      JDBCType convertedType=targetDataTypes.get(type);
      if (convertedType != null) {
        dateColumnsBuilder.put(rs.getString("column_name"),convertedType);
      }
    }
 while (rs.next());
  }
   return dateColumnsBuilder.build();
}
