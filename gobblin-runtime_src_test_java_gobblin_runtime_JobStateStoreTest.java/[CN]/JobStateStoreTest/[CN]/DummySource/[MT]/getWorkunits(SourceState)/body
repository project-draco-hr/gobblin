{
  SourceState previousSourceState=sourceState.getPreviousSourceState();
  sourceState.setProp(CURRENT_RUN_KEY,previousSourceState != null ? previousSourceState.getPropAsInt(CURRENT_RUN_KEY) + 1 : 1);
  sourceState.setProp(FOO,BAR);
  if (sourceState.getPreviousWorkUnitStates().isEmpty()) {
    return initializeWorkUnits(sourceState);
  }
  List<WorkUnit> workUnits=Lists.newArrayList();
  for (  WorkUnitState workUnitState : sourceState.getPreviousWorkUnitStates()) {
    WorkUnit workUnit=WorkUnit.create(createExtract(Extract.TableType.SNAPSHOT_ONLY,NAMESPACE,TABLE));
    workUnit.setLowWaterMark(workUnitState.getPropAsInt(ConfigurationKeys.WORK_UNIT_LOW_WATER_MARK_KEY) + NUM_WORK_UNITS * NUM_RECORDS_TO_EXTRACT_PER_EXTRACTOR);
    workUnit.setHighWaterMark(workUnitState.getPropAsInt(ConfigurationKeys.WORK_UNIT_HIGH_WATER_MARK_KEY) + NUM_WORK_UNITS * NUM_RECORDS_TO_EXTRACT_PER_EXTRACTOR);
    workUnit.setProp(WORK_UNIT_INDEX_KEY,workUnitState.getPropAsInt(WORK_UNIT_INDEX_KEY));
    workUnits.add(workUnit);
  }
  return workUnits;
}
