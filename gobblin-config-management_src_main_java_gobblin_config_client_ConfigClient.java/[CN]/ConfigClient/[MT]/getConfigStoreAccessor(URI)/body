{
  URI floorKey=this.configStoreMap.floorKey(uri);
  if (PathUtils.checkDescendant(floorKey,uri)) {
    return this.configStoreMap.get(floorKey);
  }
  ConfigStoreFactory<ConfigStore> csFactory=this.getConfigStoreFactory(uri);
  ConfigStore cs=csFactory.createConfigStore(uri);
  if (!(cs instanceof ConfigStoreWithStableVersion)) {
    if (this.policy == VersionStabilityPolicy.RAISE_ERROR) {
      throw new RuntimeException(String.format("Try to connect to unstable config store ",cs.getStoreURI()));
    }
  }
  URI csRootURI=cs.getStoreURI();
  ConfigStoreAccessor CSAccessor=new ConfigStoreAccessor(cs,cs.getCurrentVersion());
  if (!(cs instanceof ConfigStoreWithResolution)) {
    SimpleConfigStoreResolver resolver=new SimpleConfigStoreResolver(cs);
    CSAccessor.resolver=resolver;
  }
  if (!((cs instanceof ConfigStoreWithImportedBy) && (cs instanceof ConfigStoreWithImportedByRecursively))) {
    SimpleImportMappings im=null;
    if (!(cs instanceof ConfigStoreWithResolution)) {
      im=new SimpleImportMappings(CSAccessor.resolver,CSAccessor.version);
    }
 else {
      im=new SimpleImportMappings(cs,CSAccessor.version);
    }
    CSAccessor.simpleImportMappings=im;
  }
  this.configStoreMap.put(csRootURI,CSAccessor);
  LOG.info(String.format("Created new config store with uri: %s, version: %s",cs.getStoreURI(),cs.getCurrentVersion()));
  return CSAccessor;
}
