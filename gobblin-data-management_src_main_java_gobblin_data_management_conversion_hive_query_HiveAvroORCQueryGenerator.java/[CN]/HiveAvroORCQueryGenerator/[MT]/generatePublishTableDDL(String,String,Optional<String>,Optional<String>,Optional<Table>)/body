{
  List<String> ddl=Lists.newArrayList();
  String stagingDbName=optionalStagingDbName.isPresent() ? optionalStagingDbName.get() : DEFAULT_DB_NAME;
  String finalDbName=optionalFinalDbName.isPresent() ? optionalFinalDbName.get() : DEFAULT_DB_NAME;
  Preconditions.checkArgument(stagingDbName.equalsIgnoreCase(finalDbName),"We do not support staging and final " + "tables in different Hive databases because of limitations of Hive v0.13");
  if (!destinationTableMeta.isPresent()) {
    ddl.add(String.format("DROP TABLE IF EXISTS `%s`.`%s`",finalDbName,finalTableName));
    ddl.add(String.format("USE `%s`",finalDbName));
    ddl.add(String.format("ALTER TABLE `%s` RENAME TO `%s`",stagingTableName,finalTableName));
  }
  return ddl;
}
