{
  Map<String,TaskConfig> taskConfigMap=Maps.newHashMap();
  for (  WorkUnit workUnit : workUnits) {
    if (workUnit instanceof MultiWorkUnit) {
      for (      WorkUnit innerWorkUnit : JobLauncherUtils.flattenWorkUnits(((MultiWorkUnit)workUnit).getWorkUnits())) {
        addWorkUnit(innerWorkUnit,taskConfigMap,jobName,jobId);
      }
    }
 else {
      addWorkUnit(workUnit,taskConfigMap,jobName,jobId);
    }
  }
  JobConfig.Builder jobConfigBuilder=new JobConfig.Builder();
  jobConfigBuilder.addTaskConfigMap(taskConfigMap).setCommand(GobblinYarnWorkUnitRunner.GOBBLIN_TASK_FACTORY_NAME);
  return jobConfigBuilder;
}
