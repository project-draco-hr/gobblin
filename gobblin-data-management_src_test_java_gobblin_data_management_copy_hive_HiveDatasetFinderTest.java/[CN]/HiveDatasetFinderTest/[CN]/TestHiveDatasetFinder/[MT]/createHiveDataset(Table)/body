{
  if (table.getTableName().equals(THROW_EXCEPTION)) {
    throw new IOException("bad table");
  }
  HiveDataset dataset=Mockito.mock(HiveDataset.class);
  Mockito.when(dataset.getTable()).thenReturn(new org.apache.hadoop.hive.ql.metadata.Table(table));
  return dataset;
}
