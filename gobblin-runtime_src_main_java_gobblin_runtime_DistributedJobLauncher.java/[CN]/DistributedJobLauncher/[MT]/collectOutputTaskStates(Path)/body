{
  if (!this.fs.exists(outputTaskStateDir)) {
    LOGGER.warn(String.format("Output task state path %s does not exist",outputTaskStateDir));
    return;
  }
  FileStatus[] fileStatuses=this.fs.listStatus(outputTaskStateDir,new PathFilter(){
    @Override public boolean accept(    Path path){
      return path.getName().endsWith(TASK_STATE_STORE_TABLE_SUFFIX);
    }
  }
);
  if (fileStatuses == null || fileStatuses.length == 0) {
    LOGGER.warn("No output task state files found in " + outputTaskStateDir);
    return;
  }
  Queue<TaskState> taskStateQueue=Queues.newConcurrentLinkedQueue();
  try (ParallelRunner stateSerDeRunner=new ParallelRunner(stateSerDeRunnerThreads,this.fs)){
    for (    FileStatus status : fileStatuses) {
      LOGGER.info("Found output task state file " + status.getPath());
      stateSerDeRunner.deserializeFromSequenceFile(Text.class,TaskState.class,status.getPath(),taskStateQueue,true);
    }
  }
   LOGGER.info(String.format("Collected task state of %d completed tasks",taskStateQueue.size()));
  for (  TaskState taskState : taskStateQueue) {
    this.eventBus.post(new NewOutputTaskStateEvent(taskState));
  }
}
