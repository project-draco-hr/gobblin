{
  for (  URI p : previous) {
    if (uri != null && uri.equals(p)) {
      previous.add(p);
      throw new CircularDependencyException(getChain(initialURI,previous,uri));
    }
  }
  Collection<URI> imported=cs.getOwnImports(uri,version);
  Iterator<URI> it=imported.iterator();
  while (it.hasNext()) {
    URI singleImport=it.next();
    if (singleImport.equals(uri)) {
      throw new CircularDependencyException(String.format("URI %s import self",uri));
    }
    List<URI> current=new ArrayList<URI>();
    current.addAll(previous);
    current.add(uri);
    checkImportCircularDependency(cs,version,initialURI,singleImport,current);
    checkAncestorCircularDependency(cs,version,initialURI,singleImport,current);
  }
}
