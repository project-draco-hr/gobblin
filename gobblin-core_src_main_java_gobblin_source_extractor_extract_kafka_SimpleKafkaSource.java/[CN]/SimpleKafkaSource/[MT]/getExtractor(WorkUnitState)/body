{
  Preconditions.checkArgument(state.contains(EXTRACTOR_TYPE),"Missing key " + EXTRACTOR_TYPE);
  try {
    Class<? extends KafkaExtractor> klazz=ExtractorType.valueOf(state.getProp(EXTRACTOR_TYPE).toUpperCase()).getKlazz();
    return GobblinConstructorUtils.invokeLongestConstructor(klazz,state);
  }
 catch (  ReflectiveOperationException e) {
    throw new RuntimeException(e);
  }
}
