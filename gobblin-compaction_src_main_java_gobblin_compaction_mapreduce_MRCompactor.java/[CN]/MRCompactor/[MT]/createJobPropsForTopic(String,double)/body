{
  LOG.info("Creating compaction jobs for topic " + topic + " with priority "+ priority);
  Path topicSourcePath=new Path(this.inputDir,new Path(topic,this.inputSubDir));
  Path topicDestPath=new Path(this.destDir,new Path(topic,this.destSubDir));
  Path topicTmpPath=new Path(this.tmpDir,new Path(topic,this.destSubDir));
  MRCompactorJobPropCreator jobPropCreator=getJobPropCreator(topic,topicSourcePath,topicDestPath,topicTmpPath);
  List<State> allJobProps=jobPropCreator.createJobProps();
  for (  State jobProps : allJobProps) {
    this.datasets.add(new Dataset(new Path(getJobInputPath(jobProps)),jobProps,priority));
  }
}
