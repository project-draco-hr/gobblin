{
  if (state.getPropAsBoolean(ConfigurationKeys.SHOULD_FS_PROXY_AS_USER,ConfigurationKeys.DEFAULT_SHOULD_FS_PROXY_AS_USER)) {
    this.fs=new ProxiedFileSystemWrapper().getProxiedFileSystem(state,ProxiedFileSystemWrapper.AuthType.TOKEN,state.getProp(ConfigurationKeys.FS_PROXY_AS_USER_TOKEN_FILE),uri);
  }
 else {
    this.fs=FileSystem.get(URI.create(uri),this.configuration);
  }
}
