{
  String newName=name.orNull();
  if (Strings.isNullOrEmpty(newName)) {
    int randomId=RAND.nextInt();
    String oldName=context.getName();
    List<String> splitName=Splitter.on(".").splitToList(oldName);
    if (StringUtils.isNumeric(Iterables.getLast(splitName))) {
      splitName.set(splitName.size() - 1,Integer.toString(randomId));
    }
 else {
      splitName.add(Integer.toString(randomId));
    }
    newName=StringUtils.join(splitName,".");
  }
  MetricContext.Builder builder=context.getParent().isPresent() ? context.getParent().get().childBuilder(newName) : MetricContext.builder(newName);
  return builder.addTags(context.getTags()).addTags(tags).build();
}
