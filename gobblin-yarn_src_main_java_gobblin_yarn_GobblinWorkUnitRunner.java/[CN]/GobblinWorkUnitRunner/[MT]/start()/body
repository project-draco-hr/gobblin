{
  LOGGER.info(String.format("Starting %s in container %s",GobblinWorkUnitRunner.class.getSimpleName(),this.containerId));
  addShutdownHook();
  try {
    this.helixManager.connect();
    this.helixManager.getMessagingService().registerMessageHandlerFactory(Message.MessageType.SHUTDOWN.toString(),new ParticipantShutdownMessageHandlerFactory());
  }
 catch (  Exception e) {
    throw new RuntimeException("The HelixManager failed to connect",e);
  }
  registerJvmMetrics();
  this.jmxReporter.start();
  this.serviceManager.startAsync();
  this.serviceManager.awaitStopped();
}
