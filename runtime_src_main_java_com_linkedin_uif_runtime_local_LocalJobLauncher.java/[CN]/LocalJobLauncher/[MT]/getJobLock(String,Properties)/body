{
  boolean useMRJobLock=Boolean.valueOf(jobProps.getProperty(ConfigurationKeys.LOCAL_USE_MR_JOB_LOCK_KEY,Boolean.toString(false)));
  if (useMRJobLock) {
    URI fsUri=URI.create(jobProps.getProperty(ConfigurationKeys.FS_URI_KEY,ConfigurationKeys.LOCAL_FS_URI));
    return new MRJobLock(FileSystem.get(fsUri,new Configuration()),jobProps.getProperty(ConfigurationKeys.MR_JOB_LOCK_DIR_KEY),jobName);
  }
  return new LocalJobLock();
}
