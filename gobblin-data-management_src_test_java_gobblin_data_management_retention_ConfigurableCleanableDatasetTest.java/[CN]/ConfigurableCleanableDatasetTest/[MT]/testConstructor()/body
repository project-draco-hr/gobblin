{
  Config conf=ConfigFactory.parseMap(ImmutableMap.<String,String>of("gobblin.retention.version.finder.class","gobblin.data.management.retention.version.finder.WatermarkDatasetVersionFinder","gobblin.retention.retention.policy.class","gobblin.data.management.retention.policy.NewestKRetentionPolicy","gobblin.retention.newestK.versions.retained","2"));
  ConfigurableCleanableDataset<DatasetVersion> dataset=new ConfigurableCleanableDataset<DatasetVersion>(FileSystem.get(new URI(ConfigurationKeys.LOCAL_FS_URI),new Configuration()),new Properties(),new Path("/someroot"),conf,LoggerFactory.getLogger(ConfigurableCleanableDatasetTest.class));
  Assert.assertEquals(dataset.getRetentionPolicy().getClass(),NewestKRetentionPolicy.class);
  Assert.assertEquals(dataset.getVersionFinder().getClass(),WatermarkDatasetVersionFinder.class);
}
