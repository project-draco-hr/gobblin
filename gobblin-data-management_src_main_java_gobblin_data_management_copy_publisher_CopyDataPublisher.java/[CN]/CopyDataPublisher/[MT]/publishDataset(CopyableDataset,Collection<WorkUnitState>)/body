{
  Path datasetWriterOutputPath=new Path(writerOutputDir,PathUtils.withoutLeadingSeparator(copyableDataset.datasetTargetRoot()));
  log.info(String.format("Publishing dataset from %s to %s",datasetWriterOutputPath,copyableDataset.datasetTargetRoot()));
  HadoopUtils.renameRecursively(fs,datasetWriterOutputPath,copyableDataset.datasetTargetRoot());
  fs.delete(datasetWriterOutputPath,true);
  for (  WorkUnitState wus : datasetWorkUnitStates) {
    if (wus.getWorkingState() == WorkingState.SUCCESSFUL) {
      wus.setWorkingState(WorkUnitState.WorkingState.COMMITTED);
    }
  }
}
