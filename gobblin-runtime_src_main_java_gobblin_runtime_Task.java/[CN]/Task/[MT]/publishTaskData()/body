{
  Closer closer=Closer.create();
  try {
    @SuppressWarnings("unchecked") Class<? extends DataPublisher> dataPublisherClass=(Class<? extends DataPublisher>)Class.forName(this.taskState.getProp(ConfigurationKeys.DATA_PUBLISHER_TYPE,ConfigurationKeys.DEFAULT_DATA_PUBLISHER_TYPE));
    DataPublisher publisher=closer.register(DataPublisher.getInstance(dataPublisherClass,this.taskState));
    LOG.info("Publishing data from task " + this.taskId);
    publisher.publish(this.taskState);
  }
 catch (  Throwable t) {
    throw closer.rethrow(t);
  }
 finally {
    closer.close();
  }
}
