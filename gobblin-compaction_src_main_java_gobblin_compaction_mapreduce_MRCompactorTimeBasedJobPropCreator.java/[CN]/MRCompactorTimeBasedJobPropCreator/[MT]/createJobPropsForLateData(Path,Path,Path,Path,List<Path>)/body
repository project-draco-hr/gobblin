{
  if (this.state.getPropAsBoolean(ConfigurationKeys.COMPACTION_RECOMPACT_FOR_LATE_DATA,ConfigurationKeys.DEFAULT_COMPACTION_RECOMPACT_FOR_LATE_DATA)) {
    LOG.info(String.format("Will recompact for %s.",jobOutputDir));
    return createJobProps(jobInputDir,jobOutputDir,jobTmpDir,this.deduplicate);
  }
 else {
    LOG.info(String.format("Will copy %d new data files to %s",newDataFiles.size(),jobOutputDir));
    State jobProps=createJobProps(jobInputDir,jobOutputDir,jobTmpDir,this.deduplicate);
    jobProps.setProp(ConfigurationKeys.COMPACTION_JOB_LATE_DATA_MOVEMENT_TASK,true);
    jobProps.setProp(ConfigurationKeys.COMPACTION_JOB_LATE_DATA_FILES,Joiner.on(",").join(newDataFiles));
    jobProps.setProp(ConfigurationKeys.COMPACTION_JOB_DEST_LATE_DIR,jobOutputLateDir);
    return jobProps;
  }
}
