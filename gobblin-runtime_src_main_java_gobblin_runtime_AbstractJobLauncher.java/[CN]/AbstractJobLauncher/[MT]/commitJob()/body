{
  if (!canCommit(this.jobCommitPolicy,this.jobState)) {
    LOG.info("Job data will not be committed due to commit policy: " + this.jobCommitPolicy);
    return;
  }
  LOG.info(String.format("Publishing job data of job %s with commit policy %s",this.jobId,this.jobCommitPolicy.name()));
  Closer closer=Closer.create();
  try {
    Class<? extends DataPublisher> dataPublisherClass=(Class<? extends DataPublisher>)Class.forName(this.jobState.getProp(ConfigurationKeys.DATA_PUBLISHER_TYPE,ConfigurationKeys.DEFAULT_DATA_PUBLISHER_TYPE));
    Constructor<? extends DataPublisher> dataPublisherConstructor=dataPublisherClass.getConstructor(State.class);
    DataPublisher publisher=closer.register(dataPublisherConstructor.newInstance(this.jobState));
    publisher.initialize();
    publisher.publish(this.jobState.getTaskStates());
  }
 catch (  Throwable t) {
    throw closer.rethrow(t);
  }
 finally {
    closer.close();
  }
  this.jobState.setState(JobState.RunningState.COMMITTED);
}
