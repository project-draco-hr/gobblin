{
  try {
    if (!this.jobStateStore.exists(jobName,"current" + JOB_STATE_STORE_TABLE_SUFFIX)) {
      return 0;
    }
    List<? extends State> jobStateList=this.jobStateStore.getAll(jobName,"current" + JOB_STATE_STORE_TABLE_SUFFIX);
    if (jobStateList.isEmpty()) {
      return 0;
    }
    State prevJobState=jobStateList.get(0);
    return prevJobState.getPropAsInt(ConfigurationKeys.JOB_FAILURES_KEY,0);
  }
 catch (  IOException ioe) {
    LOG.warn("Failed to read the previous job state for job " + jobName,ioe);
    return 0;
  }
}
