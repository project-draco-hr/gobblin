{
  this.properties=properties;
  this.jobStateStore=new FsStateStore(properties.getProperty(ConfigurationKeys.STATE_STORE_FS_URI_KEY,ConfigurationKeys.LOCAL_FS_URI),properties.getProperty(ConfigurationKeys.STATE_STORE_ROOT_DIR_KEY),JobState.class);
  this.metricContext=new MetricContext.Builder(METRIC_CONTEXT_NAME).build();
  MetricContext.registerContext(metricContext);
  if (Boolean.valueOf(properties.getProperty(ConfigurationKeys.JOB_HISTORY_STORE_ENABLED_KEY,Boolean.FALSE.toString()))) {
    Injector injector=Guice.createInjector(new MetaStoreModule(properties));
    this.jobHistoryStore=Optional.of(injector.getInstance(JobHistoryStore.class));
  }
 else {
    this.jobHistoryStore=Optional.absent();
  }
}
