{
  Preconditions.checkArgument(jobProps.containsKey(ConfigurationKeys.JOB_NAME_KEY),"A job must have a job name specified by job.name");
  this.sysProps=new Properties();
  this.sysProps.putAll(sysProps);
  this.jobProps=new Properties();
  this.jobProps.putAll(jobProps);
  this.jobContext=new JobContext(this.sysProps,this.jobProps,LOG);
  this.cancellationExecutor=Executors.newSingleThreadExecutor(ExecutorsUtils.newThreadFactory(Optional.of(LOG),Optional.of("CancellationExecutor")));
  this.runtimeMetrics=this.jobContext.getJobMetricsOptional().transform(new Function<JobMetrics,MetricContext>(){
    @Override public MetricContext apply(    JobMetrics input){
      return input.getMetricContext();
    }
  }
);
}
