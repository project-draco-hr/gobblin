{
  if (!Optional.fromNullable(this.fs).isPresent() || !this.serviceManager.isHealthy()) {
    LOG.error("Not running the task because the mapper was not setup properly");
    return;
  }
  WorkUnit workUnit=(value.toString().endsWith(MULTI_WORK_UNIT_FILE_EXTENSION) ? new MultiWorkUnit() : new WorkUnit());
  Closer closer=Closer.create();
  try {
    InputStream is=closer.register(this.fs.open(new Path(value.toString())));
    DataInputStream dis=closer.register((new DataInputStream(is)));
    workUnit.readFields(dis);
  }
 catch (  Throwable t) {
    throw closer.rethrow(t);
  }
 finally {
    closer.close();
  }
  runWorkUnits(workUnit instanceof MultiWorkUnit ? ((MultiWorkUnit)workUnit).getWorkUnits() : Lists.newArrayList(workUnit));
}
