{
  SourceState state=new SourceState();
  state.setProp(ConfigurationKeys.SOURCE_FILEBASED_FS_URI,"file:///");
  state.setProp(ConfigurationKeys.WRITER_FILE_SYSTEM_URI,"file:///");
  state.setProp(DatasetUtils.DATASET_PROFILE_CLASS_KEY,TestCopyablePartitionableDatasedFinder.class.getCanonicalName());
  CopySource source=new CopySource();
  List<WorkUnit> workunits=source.getWorkunits(state);
  Assert.assertEquals(workunits.size(),TestCopyableDataset.FILE_COUNT);
  Extract extractAbove=null;
  Extract extractBelow=null;
  for (  WorkUnit workUnit : workunits) {
    WorkUnitState workUnitState=new WorkUnitState(workUnit);
    Assert.assertTrue(CopySource.getOriginPath(workUnitState).toString().startsWith(TestCopyableDataset.ORIGIN_PREFIX));
    Assert.assertTrue(workUnitState.getProp(ForkOperatorUtils.getPropertyNameForBranch(ConfigurationKeys.DATA_PUBLISHER_FINAL_DIR,0,0)).startsWith(TestCopyableDataset.DESTINATION_PREFIX));
    Assert.assertEquals(CopySource.getCopyableFile(workUnitState).getDestinationOwnerAndPermission(),TestCopyableDataset.OWNER_AND_PERMISSION);
    if (Integer.parseInt(CopySource.getOriginPath(workUnitState).getName()) < TestCopyablePartitionableDataset.THRESHOLD) {
      if (extractBelow == null) {
        extractBelow=workUnit.getExtract();
      }
      Assert.assertEquals(workUnit.getExtract(),extractBelow);
    }
 else {
      if (extractAbove == null) {
        extractAbove=workUnit.getExtract();
      }
      Assert.assertEquals(workUnit.getExtract(),extractAbove);
    }
  }
  Assert.assertNotNull(extractAbove);
  Assert.assertNotNull(extractBelow);
}
