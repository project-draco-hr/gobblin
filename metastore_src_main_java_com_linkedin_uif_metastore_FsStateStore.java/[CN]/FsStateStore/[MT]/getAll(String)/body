{
  Path storePath=new Path(this.storeRootDir,storeName);
  if (!this.fs.exists(storePath)) {
    throw new IOException(String.format("Task state store directory %s does not exist for job %s",storePath,storeName));
  }
  List<State> taskStates=Lists.newArrayList();
  for (  FileStatus status : this.fs.listStatus(storePath)) {
    taskStates.addAll(getAll(storeName,status.getPath().getName()));
  }
  return taskStates;
}
