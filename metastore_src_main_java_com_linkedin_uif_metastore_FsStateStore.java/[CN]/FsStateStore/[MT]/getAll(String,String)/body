{
  Path tablePath=new Path(new Path(this.storeRootDir,storeName),tableName);
  if (!this.fs.exists(tablePath)) {
    throw new IOException(String.format("Task state file %s does not exist for job %s",tablePath,tableName));
  }
  List<State> states=Lists.newArrayList();
  SequenceFile.Reader reader=null;
  try {
    reader=new SequenceFile.Reader(this.fs,tablePath,this.conf);
    try {
      Text key=new Text();
      State state=this.stateClass.newInstance();
      while (reader.next(key,state)) {
        states.add(state);
        state=this.stateClass.newInstance();
      }
    }
 catch (    Exception e) {
      throw new IOException(e);
    }
  }
  finally {
    if (reader != null) {
      reader.close();
    }
  }
  return states;
}
