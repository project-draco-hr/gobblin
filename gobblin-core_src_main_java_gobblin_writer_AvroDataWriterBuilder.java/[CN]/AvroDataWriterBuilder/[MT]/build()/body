{
  Preconditions.checkNotNull(this.destination);
  Preconditions.checkArgument(!Strings.isNullOrEmpty(this.writerId));
  Preconditions.checkNotNull(this.schema);
  Preconditions.checkArgument(this.format == WriterOutputFormat.AVRO);
switch (this.destination.getType()) {
case HDFS:
    State properties=this.destination.getProperties();
  String filePath=properties.getProp(ForkOperatorUtils.getPropertyNameForBranch(ConfigurationKeys.WRITER_FILE_PATH,this.branch));
String fileName=String.format("%s.%s.%s",properties.getProp(ForkOperatorUtils.getPropertyNameForBranch(ConfigurationKeys.WRITER_FILE_NAME,this.branch),"part"),this.writerId,this.format.getExtension());
return new AvroHdfsDataWriter(properties,filePath,fileName,this.schema,this.branch);
case KAFKA:
return new AvroKafkaDataWriter();
default :
throw new RuntimeException("Unknown destination type: " + this.destination.getType());
}
}
