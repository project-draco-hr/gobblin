{
  List<FileStatus> files=Lists.newArrayList();
  if (fs.exists(directory)) {
    getAllNestedAvroFiles(fs.getFileStatus(directory),files,fs);
    if (files.size() > 0) {
      Collections.sort(files,new Comparator<FileStatus>(){
        @Override public int compare(        FileStatus file1,        FileStatus file2){
          return Longs.compare(Long.valueOf(file2.getModificationTime()),Long.valueOf(file1.getModificationTime()));
        }
      }
);
    }
  }
  return files;
}
