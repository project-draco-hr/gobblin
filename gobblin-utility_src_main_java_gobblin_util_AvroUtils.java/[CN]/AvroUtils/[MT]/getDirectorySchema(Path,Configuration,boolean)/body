{
  Schema schema=null;
  Closer closer=Closer.create();
  try {
    List<FileStatus> files=getDirectorySchemaHelper(directory,FileSystem.get(conf));
    FileStatus file=latest ? files.get(0) : files.get(files.size() - 1);
    LOG.info("Path to get the avro schema: " + file);
    FsInput fi=new FsInput(file.getPath(),conf);
    GenericDatumReader<GenericRecord> genReader=new GenericDatumReader<GenericRecord>();
    schema=new DataFileReader<GenericRecord>(fi,genReader).getSchema();
  }
 catch (  IOException e) {
    throw new IOException("Cannot get the schema for directory " + directory);
  }
 finally {
    closer.close();
  }
  return schema;
}
