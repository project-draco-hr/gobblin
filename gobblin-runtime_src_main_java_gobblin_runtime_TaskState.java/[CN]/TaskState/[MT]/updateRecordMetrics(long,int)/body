{
  JobMetrics metrics=JobMetrics.get(this.getProp(ConfigurationKeys.JOB_NAME_KEY),this.jobId);
  String forkBranchId=ForkOperatorUtils.getForkId(this.taskId,branchIndex);
  Counter taskRecordCounter=metrics.getCounter(JobMetrics.metricName(MetricGroup.TASK,forkBranchId,RECORDS));
  long inc=recordsWritten - taskRecordCounter.getCount();
  taskRecordCounter.inc(inc);
  metrics.getMeter(JobMetrics.metricName(MetricGroup.TASK,forkBranchId,RECORDS_PER_SECOND)).mark(inc);
  metrics.getCounter(JobMetrics.metricName(MetricGroup.JOB,this.jobId,RECORDS)).inc(inc);
  metrics.getMeter(JobMetrics.metricName(MetricGroup.JOB,this.jobId,RECORDS_PER_SECOND)).mark(inc);
}
