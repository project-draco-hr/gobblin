{
  Properties properties=new Properties();
  properties.setProperty(ConfigurationKeys.JOB_CONFIG_FILE_GENERAL_PATH_KEY,this.jobConfigDir.getAbsolutePath());
  List<JobSpec> jobSpecs=Lists.transform(Lists.newArrayList(loader.loadPullFilesRecursively(loader.getRootDirectory(),this.sysConfig,false)),this.converter);
  List<Properties> jobConfigs=convertJobSpecList2PropList(jobSpecs);
  Assert.assertEquals(jobConfigs.size(),4);
  Properties jobProps1=getJobConfigForFile(jobConfigs,"test111.pull");
  Assert.assertEquals(jobProps1.stringPropertyNames().size(),4);
  Assert.assertTrue(jobProps1.containsKey(ConfigurationKeys.JOB_CONFIG_FILE_PATH_KEY));
  Assert.assertEquals(jobProps1.getProperty("k1"),"d1");
  Assert.assertEquals(jobProps1.getProperty("k8"),"a8");
  Assert.assertEquals(jobProps1.getProperty("k9"),"a8");
  Properties jobProps2=getJobConfigForFile(jobConfigs,"test11.pull");
  Assert.assertEquals(jobProps2.stringPropertyNames().size(),4);
  Assert.assertTrue(jobProps2.containsKey(ConfigurationKeys.JOB_CONFIG_FILE_PATH_KEY));
  Assert.assertEquals(jobProps2.getProperty("k1"),"c1");
  Assert.assertEquals(jobProps2.getProperty("k3"),"b3");
  Assert.assertEquals(jobProps2.getProperty("k6"),"a6");
  Properties jobProps3=getJobConfigForFile(jobConfigs,"test12.PULL");
  Assert.assertEquals(jobProps3.stringPropertyNames().size(),2);
  Assert.assertTrue(jobProps3.containsKey(ConfigurationKeys.JOB_CONFIG_FILE_PATH_KEY));
  Assert.assertEquals(jobProps3.getProperty("k7"),"a7");
  Properties jobProps4=getJobConfigForFile(jobConfigs,"test21.PULL");
  Assert.assertEquals(jobProps4.stringPropertyNames().size(),2);
  Assert.assertTrue(jobProps4.containsKey(ConfigurationKeys.JOB_CONFIG_FILE_PATH_KEY));
  Assert.assertEquals(jobProps4.getProperty("k5"),"b5");
}
