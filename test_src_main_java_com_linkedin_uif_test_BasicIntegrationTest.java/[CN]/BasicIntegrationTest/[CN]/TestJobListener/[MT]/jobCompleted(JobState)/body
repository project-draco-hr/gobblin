{
  Assert.assertEquals(jobState.getState(),JobState.RunningState.COMMITTED);
  Assert.assertEquals(jobState.getCompletedTasks(),2);
  for (  TaskState taskState : jobState.getTaskStates()) {
    File sourceFile=new File(taskState.getProp(SOURCE_FILE_KEY));
    File targetFile=new File(taskState.getProp(ConfigurationKeys.JOB_FINAL_DIR_HDFS),taskState.getProp(ConfigurationKeys.FILE_NAME_KEY) + "." + taskState.getTaskId());
    Assert.assertEquals(taskState.getWorkingState(),WorkUnitState.WorkingState.COMMITTED);
    try {
      Assert.assertEquals(sourceFile.length(),targetFile.length());
      Assert.assertFalse(Files.equal(sourceFile,targetFile));
    }
 catch (    IOException ioe) {
      Assert.fail();
    }
  }
  latch.countDown();
}
