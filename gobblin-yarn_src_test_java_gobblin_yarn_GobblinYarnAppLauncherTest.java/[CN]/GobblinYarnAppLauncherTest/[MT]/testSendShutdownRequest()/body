{
  this.helixManager.connect();
  this.helixManager.getMessagingService().registerMessageHandlerFactory(Message.MessageType.SHUTDOWN.toString(),new TestShutdownMessageHandlerFactory(this));
  this.gobblinYarnAppLauncher.connectHelixManager();
  this.gobblinYarnAppLauncher.sendShutdownRequest();
  Assert.assertEquals(this.curatorFramework.checkExists().forPath(String.format("/%s/CONTROLLER/MESSAGES",GobblinYarnAppLauncherTest.class.getSimpleName())).getVersion(),0);
  Thread.sleep(500);
  Assert.assertEquals(this.curatorFramework.getChildren().forPath(String.format("/%s/CONTROLLER/MESSAGES",GobblinYarnAppLauncherTest.class.getSimpleName())).size(),1);
  Thread.sleep(2000);
  Assert.assertEquals(this.curatorFramework.getChildren().forPath(String.format("/%s/CONTROLLER/MESSAGES",GobblinYarnAppLauncherTest.class.getSimpleName())).size(),0);
}
