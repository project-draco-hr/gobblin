{
  if (hiveUnit.getLocation().isPresent()) {
    Schema avroSchema=AvroUtils.getDirectorySchema(new Path(hiveUnit.getLocation().get()),this.fs,true);
    if (avroSchema == null) {
      throw new IOException(String.format("No avro schema found for directory %s ",hiveUnit.getLocation().get()));
    }
    return avroSchema;
  }
  throw new IOException(String.format("No data location found for hiveUnit %s ",hiveUnit));
}
