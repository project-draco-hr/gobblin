{
  for (  FileStatus status : HadoopUtils.listStatusRecursive(this.fileSystemByBranches.get(branchId),writerOutput)) {
    String filePathStr=status.getPath().toString();
    String pathSuffix=filePathStr.substring(filePathStr.indexOf(writerOutput.toString()) + writerOutput.toString().length() + 1);
    Path outputPath=new Path(publisherOutput,pathSuffix);
    if (!this.fileSystemByBranches.get(branchId).exists(outputPath.getParent())) {
      this.fileSystemByBranches.get(branchId).mkdirs(outputPath.getParent());
    }
    LOG.info(String.format("Moving %s to %s",status.getPath(),outputPath));
    parallelRunner.renamePath(status.getPath(),outputPath,Optional.<String>absent());
  }
}
