{
  String s3Endpoint;
  if (Regions.US_EAST_1.equals(region)) {
    s3Endpoint=String.format("%s.amazonaws.com",AWS_S3_SERVICE);
  }
 else {
    s3Endpoint=String.format("%s-%s.amazonaws.com",AWS_S3_SERVICE,region);
  }
  final AmazonS3 s3;
  if (awsClusterSecurityManager.isAssumeRoleEnabled()) {
    s3=new AmazonS3Client(awsClusterSecurityManager.getBasicSessionCredentials());
  }
 else {
    s3=new AmazonS3Client(awsClusterSecurityManager.getBasicAWSCredentials());
  }
  s3.setEndpoint(s3Endpoint);
  return s3;
}
