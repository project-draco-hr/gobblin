{
  if (lastRefreshCacheTime > 0 && lastRefreshCacheTime >= awsClusterSecurityManager.getLastRefreshTimeInMillis()) {
    return amazonEC2;
  }
synchronized (AWSSdkClient.class) {
    if (lastRefreshCacheTime > 0 && lastRefreshCacheTime >= awsClusterSecurityManager.getLastRefreshTimeInMillis()) {
      if (awsClusterSecurityManager.isAssumeRoleEnabled()) {
        amazonEC2=new AmazonEC2Client(awsClusterSecurityManager.getBasicSessionCredentials());
      }
 else {
        amazonEC2=new AmazonEC2Client(awsClusterSecurityManager.getBasicAWSCredentials());
      }
      amazonEC2.setRegion(region);
    }
  }
  return amazonEC2;
}
