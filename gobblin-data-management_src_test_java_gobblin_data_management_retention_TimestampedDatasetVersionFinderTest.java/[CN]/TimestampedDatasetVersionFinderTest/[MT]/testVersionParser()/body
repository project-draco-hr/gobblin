{
  Properties props=new Properties();
  props.put(DateTimeDatasetVersionFinder.DATE_TIME_PATTERN_KEY,"yyyy/MM/dd/hh/mm");
  DateTimeDatasetVersionFinder parser=new DateTimeDatasetVersionFinder(null,props);
  Assert.assertEquals(parser.versionClass(),TimestampedDatasetVersion.class);
  Assert.assertEquals(parser.globVersionPattern(),new Path("*/*/*/*/*"));
  DateTime version=parser.getDatasetVersion(new Path("2015/06/01/10/12"),new Path("fullPath")).getDateTime();
  Assert.assertEquals(version.getZone(),DateTimeZone.forID("America/Los_Angeles"));
  Assert.assertEquals(version,new DateTime(2015,6,1,10,12,0,0,DateTimeZone.forID("America/Los_Angeles")));
  Assert.assertEquals(parser.getDatasetVersion(new Path("2015/06/01/10/12"),new Path("fullPath")).getPathsToDelete().iterator().next(),new Path("fullPath"));
}
