{
  TestSource testSource=new TestSource();
  SourceState mockedState=mock(SourceState.class);
  List<WorkUnitState> previousWorkUnitStates=Collections.singletonList(new WorkUnitState());
  when(mockedState.getPreviousWorkUnitStates()).thenReturn(previousWorkUnitStates);
  when(mockedState.contains(ConfigurationKeys.WORK_UNIT_RETRY_POLICY_KEY)).thenReturn(Boolean.TRUE);
  when(mockedState.getProp(ConfigurationKeys.WORK_UNIT_RETRY_POLICY_KEY)).thenReturn("onpartial");
  when(mockedState.getProp(ConfigurationKeys.JOB_COMMIT_POLICY_KEY,ConfigurationKeys.DEFAULT_JOB_COMMIT_POLICY)).thenReturn("partial");
  Assert.assertEquals(testSource.getPreviousWorkUnitStatesForRetry(mockedState),previousWorkUnitStates);
}
