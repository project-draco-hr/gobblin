{
  Map<String,Object> values=this.jobMetricsStore.aggregateOnJobRuns(JOB_NAME_1,RECORD_COUNTER,MetricNameSuffix.NONE,AggregationFunction.SUM);
  Assert.assertEquals(values.size(),1);
  Assert.assertEquals(((Double)values.get(JOB_ID_1)).longValue(),1000l);
  values=this.jobMetricsStore.aggregateOnJobRuns(JOB_NAME_1,BYTE_COUNTER,MetricNameSuffix.NONE,AggregationFunction.SUM);
  Assert.assertEquals(values.size(),1);
  Assert.assertEquals(((Double)values.get(JOB_ID_1)).longValue(),1000 * 100l);
  values=this.jobMetricsStore.aggregateOnJobRuns(JOB_NAME_2,RECORD_COUNTER,MetricNameSuffix.NONE,AggregationFunction.SUM);
  Assert.assertEquals(values.size(),1);
  Assert.assertEquals(((Double)values.get(JOB_ID_2)).longValue(),2000l);
  values=this.jobMetricsStore.aggregateOnJobRuns(JOB_NAME_2,BYTE_COUNTER,MetricNameSuffix.NONE,AggregationFunction.SUM);
  Assert.assertEquals(values.size(),1);
  Assert.assertEquals(((Double)values.get(JOB_ID_2)).longValue(),2000 * 100l);
}
