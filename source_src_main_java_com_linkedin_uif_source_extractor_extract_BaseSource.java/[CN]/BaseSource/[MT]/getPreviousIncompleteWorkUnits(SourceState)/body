{
  LOG.debug("Getting previous unsuccessful work units");
  List<WorkUnit> previousWorkUnits=new ArrayList<WorkUnit>();
  List<WorkUnitState> previousWorkUnitStates=state.getPreviousStates();
  if (previousWorkUnitStates.size() == 0) {
    LOG.debug("Previous states are not found");
    return previousWorkUnits;
  }
  for (  WorkUnitState workUnitState : previousWorkUnitStates) {
    if (workUnitState.getWorkingState() == WorkingState.FAILED || workUnitState.getWorkingState() == WorkingState.ABORTED) {
      previousWorkUnits.add(workUnitState.getWorkunit());
    }
  }
  return previousWorkUnits;
}
