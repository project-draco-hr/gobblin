{
  if (workunit.getLowWaterMark() == ConfigurationKeys.DEFAULT_WATERMARK_VALUE) {
    return ConfigurationKeys.DEFAULT_WATERMARK_VALUE;
  }
  WatermarkType wmType=WatermarkType.valueOf(watermarkType.toUpperCase());
  int deltaNum=new WatermarkPredicate(null,wmType).getDeltaNumForNextWatermark();
  if (wmType == WatermarkType.SIMPLE) {
    return workunit.getLowWaterMark() - deltaNum;
  }
 else {
    return Long.parseLong(Utils.dateToString(Utils.addSecondsToDate(Utils.toDate(workunit.getLowWaterMark(),"yyyyMMddHHmmss"),deltaNum * -1),"yyyyMMddHHmmss"));
  }
}
