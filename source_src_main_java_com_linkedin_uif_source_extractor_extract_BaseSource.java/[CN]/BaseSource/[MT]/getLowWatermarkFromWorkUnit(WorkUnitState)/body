{
  String watermarkType=workUnitState.getProp(ConfigurationKeys.SOURCE_WATERMARK_TYPE);
  long lowWaterMark=workUnitState.getWorkunit().getLowWaterMark();
  if (lowWaterMark == ConfigurationKeys.DEFAULT_WATERMARK_VALUE) {
    return lowWaterMark;
  }
  WatermarkType wmType=WatermarkType.valueOf(watermarkType.toUpperCase());
  int deltaNum=new WatermarkPredicate(null,wmType).getDeltaNumForNextWatermark();
  int backupSecs=Utils.getAsInt(workUnitState.getProp(ConfigurationKeys.SOURCE_LOW_WATERMARK_BACKUP_SECS));
switch (wmType) {
case SIMPLE:
    return lowWaterMark + backupSecs - deltaNum;
default :
  Date lowWaterMarkDate=Utils.toDate(lowWaterMark,"yyyyMMddHHmmss");
return Long.parseLong(Utils.dateToString(Utils.addSecondsToDate(lowWaterMarkDate,backupSecs - deltaNum),"yyyyMMddHHmmss"));
}
}
