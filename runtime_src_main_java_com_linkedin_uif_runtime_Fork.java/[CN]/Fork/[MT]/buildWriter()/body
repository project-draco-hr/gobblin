{
  String branchName=ForkOperatorUtils.getBranchName(this.taskState,this.index,ConfigurationKeys.DEFAULT_FORK_BRANCH_NAME + this.index);
  String writerFilePathKey=ForkOperatorUtils.getPropertyNameForBranch(ConfigurationKeys.WRITER_FILE_PATH,this.branches,this.index);
  if (!this.taskState.contains(writerFilePathKey)) {
    this.taskState.setProp(writerFilePathKey,ForkOperatorUtils.getPathForBranch(this.taskState.getExtract().getOutputFilePath(),branchName,this.branches));
  }
  return this.taskContext.getDataWriterBuilder(this.branches,this.index).writeTo(Destination.of(this.taskContext.getDestinationType(this.branches,this.index),this.taskState)).writeInFormat(this.taskContext.getWriterOutputFormat(this.branches,this.index)).withWriterId(this.taskId).withSchema(this.convertedSchema).forBranch(this.branches > 1 ? this.index : -1).build();
}
