{
  if (Metrics.isEnabled(this.properties)) {
    long metricsReportInterval=Long.parseLong(this.properties.getProperty(ConfigurationKeys.METRICS_REPORT_INTERVAL_KEY,ConfigurationKeys.DEFAULT_METRICS_REPORT_INTERVAL));
    Metrics.startCsvReporter(metricsReportInterval,this.properties.getProperty(ConfigurationKeys.METRICS_DIR_KEY));
  }
  Runtime.getRuntime().addShutdownHook(new Thread(){
    public void run(){
      LOG.info("Shutting down the scheduler daemon");
      try {
        serviceManager.stopAsync().awaitStopped(5,TimeUnit.SECONDS);
      }
 catch (      TimeoutException te) {
        LOG.error("Timeout in stopping the service manager",te);
      }
    }
  }
);
  LOG.info("Starting the scheduler daemon");
  this.serviceManager.startAsync();
}
