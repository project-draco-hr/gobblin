{
  if (!fileSystem.exists(from)) {
    return;
  }
  for (  FileStatus fromFile : fileSystem.listStatus(from)) {
    Path relativeFilePath=new Path(StringUtils.substringAfter(fromFile.getPath().toString(),from.toString() + Path.SEPARATOR));
    Path toFilePath=new Path(to,relativeFilePath);
    if (!safeRenameIfNotExists(fileSystem,fromFile.getPath(),toFilePath)) {
      if (fromFile.isDir()) {
        renameRecursively(fileSystem,fromFile.getPath(),toFilePath);
      }
 else {
        log.info(String.format("File already exists %s. Will not rewrite",toFilePath));
      }
    }
  }
}
