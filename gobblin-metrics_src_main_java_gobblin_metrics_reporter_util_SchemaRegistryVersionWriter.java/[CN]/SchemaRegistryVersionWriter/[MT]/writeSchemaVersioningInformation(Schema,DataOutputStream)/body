{
  if (!this.registrySchemaIds.containsKey(schema)) {
    String schemaId=this.registry.register(schema);
    this.registrySchemaIds.put(schema,schemaId);
  }
  outputStream.writeByte(KafkaAvroSchemaRegistry.MAGIC_BYTE);
  try {
    outputStream.write(Hex.decodeHex(this.registrySchemaIds.get(schema).toCharArray()));
  }
 catch (  DecoderException exception) {
    throw new IOException(exception);
  }
}
