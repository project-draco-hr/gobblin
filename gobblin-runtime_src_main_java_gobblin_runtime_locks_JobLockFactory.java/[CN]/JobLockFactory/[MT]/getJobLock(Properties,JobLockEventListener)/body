{
  Preconditions.checkNotNull(properties);
  Preconditions.checkNotNull(jobLockEventListener);
  JobLock jobLock;
  if (properties.containsKey(ConfigurationKeys.JOB_LOCK_TYPE)) {
    try {
      Class<?> jobLockClass=Class.forName(properties.getProperty(ConfigurationKeys.JOB_LOCK_TYPE,FileBasedJobLock.class.getName()));
      jobLock=(JobLock)jobLockClass.newInstance();
    }
 catch (    ClassNotFoundException|InstantiationException|IllegalAccessException e) {
      throw new JobLockException(e);
    }
  }
 else {
    jobLock=new FileBasedJobLock();
  }
  jobLock.initialize(properties,jobLockEventListener);
  return jobLock;
}
