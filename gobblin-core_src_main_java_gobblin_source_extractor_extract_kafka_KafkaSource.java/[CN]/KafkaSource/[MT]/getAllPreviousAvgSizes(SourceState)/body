{
  this.previousAvgSizes.clear();
  for (  WorkUnitState workUnitState : state.getPreviousWorkUnitStates()) {
    KafkaPartition partition=getKafkaPartitionFromState(workUnitState);
    if (partition == null) {
      continue;
    }
    long previousAvgSize=workUnitState.getPropAsLong(getWorkUnitSizePropName(workUnitState),DEFAULT_AVG_EVENT_SIZE);
    this.previousAvgSizes.put(partition,previousAvgSize);
  }
}
