{
  this.previousAvgSizes.clear();
  for (  WorkUnitState workUnitState : state.getPreviousWorkUnitStates()) {
    List<KafkaPartition> partitions=KafkaUtils.getPartitions(workUnitState);
    for (    KafkaPartition partition : partitions) {
      long previousAvgSize=KafkaUtils.getPartitionAvgEventSize(workUnitState,partition,DEFAULT_AVG_EVENT_SIZE);
      this.previousAvgSizes.put(partition,previousAvgSize);
    }
  }
}
