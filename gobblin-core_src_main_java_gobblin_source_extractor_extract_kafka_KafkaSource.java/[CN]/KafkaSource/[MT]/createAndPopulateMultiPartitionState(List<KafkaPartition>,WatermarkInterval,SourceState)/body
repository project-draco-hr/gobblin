{
  Preconditions.checkArgument(!partitions.isEmpty(),"There should be at least one partition");
  SourceState partitionsState=new SourceState();
  partitionsState.addAll(state);
  partitionsState.setProp(TOPIC_NAME,partitions.get(0).getTopicName());
  GobblinMetrics.addCustomTagToState(partitionsState,new Tag<String>("kafkaTopic",partitions.get(0).getTopicName()));
  partitionsState.setProp(ConfigurationKeys.EXTRACT_TABLE_NAME_KEY,partitions.get(0).getTopicName());
  for (int i=0; i < partitions.size(); i++) {
    partitionsState.setProp(KafkaUtils.getPartitionPropName(KafkaSource.PARTITION_ID,i),partitions.get(i).getId());
    partitionsState.setProp(KafkaUtils.getPartitionPropName(KafkaSource.LEADER_ID,i),partitions.get(i).getLeader().getId());
    partitionsState.setProp(KafkaUtils.getPartitionPropName(KafkaSource.LEADER_HOSTANDPORT,i),partitions.get(i).getLeader().getHostAndPort());
  }
  return partitionsState;
}
