{
  Counter taskRecordCounter=Metrics.getCounter(Metrics.metricName("task",this.taskId,"records"));
  Counter jobRecordCounter=Metrics.getCounter(Metrics.metricName("job",this.jobId,"records"));
  Meter taskRecordMeter=Metrics.getMeter(Metrics.metricName("task",this.taskId,"recordsPerSec"));
  Meter jobRecordMeter=Metrics.getMeter(Metrics.metricName("job",this.jobId,"recordsPerSec"));
  long recordsWritten=this.writer.recordsWritten();
  long inc=recordsWritten - taskRecordCounter.getCount();
  taskRecordCounter.inc(inc);
  taskRecordMeter.mark(recordsWritten);
synchronized (Metrics.class) {
    jobRecordCounter.inc(inc);
    jobRecordMeter.mark(jobRecordMeter.getCount() + inc);
  }
}
