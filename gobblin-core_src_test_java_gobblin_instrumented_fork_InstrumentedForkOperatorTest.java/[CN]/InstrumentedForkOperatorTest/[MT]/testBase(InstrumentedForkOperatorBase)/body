{
  fork.init(new WorkUnitState());
  fork.forkDataRecord(new WorkUnitState(),"in");
  Map<String,Long> metrics=MetricsHelper.dumpMetrics(fork.metricContext);
  Assert.assertEquals(metrics.get(MetricNames.ForkOperator.RECORDS_IN),Long.valueOf(1));
  Assert.assertEquals(metrics.get(MetricNames.ForkOperator.FORKS_OUT),Long.valueOf(2));
  Assert.assertEquals(metrics.get(MetricNames.ForkOperator.FORK_TIME),Long.valueOf(1));
  Assert.assertEquals(MetricsHelper.dumpTags(fork.metricContext).get("construct"),Constructs.FORK_OPERATOR.toString());
}
