{
  String keyTabFilePath=this.config.getString(ConfigurationConstants.KEYTAB_FILE_PATH);
  if (Strings.isNullOrEmpty(keyTabFilePath)) {
    throw new IOException("Keytab file path is not defined for Kerberos login");
  }
  if (!new File(keyTabFilePath).exists()) {
    throw new IOException("Keytab file not found at: " + keyTabFilePath);
  }
  String principal=this.config.getString(ConfigurationConstants.KEYTAB_PRINCIPAL_NAME);
  if (Strings.isNullOrEmpty(principal)) {
    principal=this.currentUser.getShortUserName() + "/localhost@LOCALHOST";
  }
  Configuration conf=new Configuration();
  conf.set("hadoop.security.authentication",UserGroupInformation.AuthenticationMethod.KERBEROS.toString().toLowerCase());
  UserGroupInformation.setConfiguration(conf);
  UserGroupInformation.loginUserFromKeytab(principal,keyTabFilePath);
  LOGGER.info(String.format("Logged in from keytab file %s using principal %s",keyTabFilePath,principal));
  this.currentUser=UserGroupInformation.getCurrentUser();
  getNewDelegationTokenForLoginUser();
  writeDelegationTokenToFile();
}
