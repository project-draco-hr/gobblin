{
  this.state=builder.destination.getProperties();
  this.state.appendToListProp(ConfigurationKeys.FORK_BRANCH_ID_KEY,Integer.toString(builder.branch));
  String databaseTableKey=ForkOperatorUtils.getPropertyNameForBranch(ConfigurationKeys.JDBC_PUBLISHER_DATABASE_NAME,builder.branches,builder.branch);
  this.databaseName=Objects.requireNonNull(state.getProp(databaseTableKey),"Staging table is missing with key " + databaseTableKey);
  String stagingTableKey=ForkOperatorUtils.getPropertyNameForBranch(ConfigurationKeys.WRITER_STAGING_TABLE,builder.branches,builder.branch);
  this.tableName=Objects.requireNonNull(state.getProp(stagingTableKey),"Staging table is missing with key " + stagingTableKey);
  this.commands=new JdbcWriterCommandsFactory().newInstance(state);
  try {
    this.conn=createConnection();
    conn.setAutoCommit(false);
  }
 catch (  SQLException e) {
    throw new RuntimeException(e);
  }
}
